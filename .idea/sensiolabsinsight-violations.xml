<?xml version="1.0" encoding="UTF-8"?>
<analysis>
  <link href="https://insight.sensiolabs.com/api/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87" rel="self" type="application/vnd.com.sensiolabs.insight+xml"/>
  <link href="https://insight.sensiolabs.com/api/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87/status" rel="status" type="application/vnd.com.sensiolabs.insight+xml"/>
  <link href="https://insight.sensiolabs.com/api/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217" rel="project" type="application/vnd.com.sensiolabs.insight+xml"/>
  <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87" rel="self" type="text/html"/>
  <status><![CDATA[]]></status>
  <violations>
    <violation severity="minor" category="deadcode" ignored="false">
      <line>438</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Commented code should not be committed</title>
      <message><![CDATA[Commented out code reduces readability and lowers the code confidence for other developers. If it's common usage for debug, it should not be committed. Using a version control system, such code can be safely removed.]]></message>
      <context start-line="433" end-line="443"><![CDATA[            $range = sprintf("%u.%u.%u.%u", empty($a)?'0':$a, empty($b)?'0':$b,empty($c)?'0':$c,empty($d)?'0':$d);
            $range_dec = ip2long($range);
            $ip_dec = ip2long($ip);

            # Strategy 1 - Create the netmask with 'netmask' 1s and then fill it to 32 with 0s
            #$netmask_dec = bindec(str_pad('', $netmask, '1') . str_pad('', 32-$netmask, '0'));

            # Strategy 2 - Use math to create it
            $wildcard_dec = pow(2, (32-$netmask)) - 1;
            $netmask_dec = ~ $wildcard_dec;
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628046" rel="self" type="text/html"/>
    </violation>
    <violation severity="minor" category="bugrisk" ignored="false">
      <line>1104</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Error silenced by the at sign (@)</title>
      <message><![CDATA[Adding "@" before \get_headers($theURL) prevents warning and errors during this function execution from being displayed.
If you need to do that, you should probably implement a better way to qualify and recover from errors, using Exceptions.]]></message>
      <context start-line="1099" end-line="1109"><![CDATA[                        'method' => 'HEAD'
                    )
                )
            );
        }
        $headers = @get_headers($theURL);

        if ($headers === false || isNullOrEmptyArray($headers) || strlen($headers[0]) < 12) {
            return 999;
        }
        $status = substr($headers[0], 9, 3);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628077" rel="self" type="text/html"/>
    </violation>
    <violation severity="minor" category="bugrisk" ignored="false">
      <line>72</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Error silenced by the at sign (@)</title>
      <message><![CDATA[Adding "@" before \inet_pton($ip) prevents warning and errors during this function execution from being displayed.
If you need to do that, you should probably implement a better way to qualify and recover from errors, using Exceptions.]]></message>
      <context start-line="67" end-line="77"><![CDATA[ * @param string $ip
 * @return string
 */
function anonimizeIpWithInet(string $ip):string
{
    if ($ip = @inet_pton($ip)) {
        return inet_ntop(substr($ip, 0, strlen($ip) / 2) . str_repeat(chr(0), strlen($ip) / 2));
    }
    return '0.0.0.0';
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628050" rel="self" type="text/html"/>
    </violation>
    <violation severity="minor" category="bugrisk" ignored="false">
      <line>270</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Error silenced by the at sign (@)</title>
      <message><![CDATA[Adding "@" before \inet_pton('::1') prevents warning and errors during this function execution from being displayed.
If you need to do that, you should probably implement a better way to qualify and recover from errors, using Exceptions.]]></message>
      <context start-line="265" end-line="275"><![CDATA[ *
 * @throws \RuntimeException When IPV6 support is not enabled
 */
function checkIp6($requestIp, $ip) : bool
{
    if (!((extension_loaded('sockets') && defined('AF_INET6')) || @inet_pton('::1'))) {
        throw new \RuntimeException('Unable to check Ipv6. Check that PHP was not compiled with option "disable-ipv6".');
    }
    if (false !== strpos($ip, '/')) {
        list($address, $netmask) = explode('/', $ip, 2);
        if ($netmask < 1 || $netmask > 128) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628092" rel="self" type="text/html"/>
    </violation>
    <violation severity="minor" category="bugrisk" ignored="false">
      <line>282</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Error silenced by the at sign (@)</title>
      <message><![CDATA[Adding "@" before \inet_pton($address) prevents warning and errors during this function execution from being displayed.
If you need to do that, you should probably implement a better way to qualify and recover from errors, using Exceptions.]]></message>
      <context start-line="277" end-line="287"><![CDATA[        }
    } else {
        $address = $ip;
        $netmask = 128;
    }
    $bytesAddr = unpack('n*', @inet_pton($address));
    $bytesTest = unpack('n*', @inet_pton($requestIp));
    if (empty($bytesAddr) || empty($bytesTest)) {
        return false;
    }
    for ($i = 1, $ceil = ceil($netmask / 16); $i <= $ceil; ++$i) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628027" rel="self" type="text/html"/>
    </violation>
    <violation severity="minor" category="bugrisk" ignored="false">
      <line>283</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Error silenced by the at sign (@)</title>
      <message><![CDATA[Adding "@" before \inet_pton($requestIp) prevents warning and errors during this function execution from being displayed.
If you need to do that, you should probably implement a better way to qualify and recover from errors, using Exceptions.]]></message>
      <context start-line="278" end-line="288"><![CDATA[    } else {
        $address = $ip;
        $netmask = 128;
    }
    $bytesAddr = unpack('n*', @inet_pton($address));
    $bytesTest = unpack('n*', @inet_pton($requestIp));
    if (empty($bytesAddr) || empty($bytesTest)) {
        return false;
    }
    for ($i = 1, $ceil = ceil($netmask / 16); $i <= $ceil; ++$i) {
        $left = $netmask - 16 * ($i - 1);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628044" rel="self" type="text/html"/>
    </violation>
    <violation severity="minor" category="bugrisk" ignored="false">
      <line>597</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Booleans and null should be compared strictly</title>
      <message><![CDATA[With booleans and null, only strict comparison (with === operator) should be used to lower bug risks and to improve performances.]]></message>
      <context start-line="592" end-line="602"><![CDATA[            $version = $matches['version'][1];
        }
    } else {
        $version = $matches['version'][0];
    }
    if ($version == null || $version == '') {
        $version = '?';
    }
    return implode(', ', [$browserName, 'Version: ' . $version, $platform]);
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628071" rel="self" type="text/html"/>
    </violation>
    <violation severity="minor" category="deadcode" ignored="false">
      <line>174</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Unused method, property, variable or parameter</title>
      <message><![CDATA[This key local variable is declared but never used. You should remove it.]]></message>
      <context start-line="169" end-line="179"><![CDATA[    $result = array();
    if (isNullOrEmptyArray($array)) {
        return $result;
    }
    reset($array);
    while (list($key, $value) = each($array)) {
        if (isInteger($value)) {
            $result[] = $value;
        }
    }
    reset($array);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628055" rel="self" type="text/html"/>
    </violation>
    <violation severity="minor" category="deadcode" ignored="false">
      <line>597</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Unused method, property, variable or parameter</title>
      <message><![CDATA[This calendar argument is declared but never used. You should remove it.]]></message>
      <context start-line="592" end-line="602"><![CDATA[     * @param $calendar
     * @param int $month
     * @param int $year
     * @return int
     */
    function cal_days_in_month($calendar = CAL_GREGORIAN, $month, $year) : int
    {
        if (!isInRange($month, 1, 12) || $year < 1) {
            return 0;
        }
        $dim = date('t', mktime(0, 0, 0, $month, 1, $year));]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627995" rel="self" type="text/html"/>
    </violation>
    <violation severity="minor" category="bugrisk" ignored="false">
      <line>174</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Avoid using deprecated PHP functions</title>
      <message><![CDATA[each() has been deprecated in PHP 7.2 and will be removed from PHP in the next major version.]]></message>
      <context start-line="169" end-line="179"><![CDATA[    $result = array();
    if (isNullOrEmptyArray($array)) {
        return $result;
    }
    reset($array);
    while (list($key, $value) = each($array)) {
        if (isInteger($value)) {
            $result[] = $value;
        }
    }
    reset($array);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628145" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>12</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[get() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="7" end-line="17"><![CDATA[     * @param  array $array
     * @param  string $key
     * @param  mixed $default
     * @return mixed
     */
    function get($array, $key, $default = null)
    {
        if (is_null($key)) {
            return $array;
        }
        if (isset($array[$key])) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628189" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>37</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[head() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="32" end-line="42"><![CDATA[     * Get the first element of an array. Useful for method chaining.
     *
     * @param  array $array
     * @return mixed
     */
    function head($array)
    {
        return reset($array);
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628012" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>50</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[last() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="45" end-line="55"><![CDATA[     * Get the last element from an array.
     *
     * @param  array $array
     * @return mixed
     */
    function last($array)
    {
        return end($array);
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628013" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>66</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[insert_at_top() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="61" end-line="71"><![CDATA[     * @param $elem
     * @param int $count
     * @return bool
     * @see https://github.com/ifsnop/lpsf/blob/master/src/Ifsnop/functions.inc.php
     */
    function insert_at_top(&$my_arr, $elem, int $count = 10) : bool
    {
        if (!is_array($my_arr) || is_null($elem)) {
            return false;
        }
        array_splice($my_arr, $count - 1);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628176" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>85</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[array_has() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="80" end-line="90"><![CDATA[     *
     * @param  array $array
     * @param  string $key
     * @return bool
     */
    function array_has($array, $key)
    {
        if (empty($array) || is_null($key)) {
            return false;
        }
        if (array_key_exists($key, $array)) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628192" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>112</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[array_get() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="107" end-line="117"><![CDATA[     * @param  array $array
     * @param  string $key
     * @param  mixed $default
     * @return mixed
     */
    function array_get($array, $key, $default = null)
    {
        if (is_null($key)) {
            return $array;
        }
        if (isset($array[$key])) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628194" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>141</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[array_set() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="136" end-line="146"><![CDATA[     * @param  array $array
     * @param  string $key
     * @param  mixed $value
     * @return array
     */
    function array_set(&$array, $key, $value)
    {
        if (is_null($key)) {
            return $array = $value;
        }
        $keys = explode('.', $key);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628131" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>167</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[CleanUpArrayOfInt() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="162" end-line="172"><![CDATA[/**
 * Return an array with only integers value contained in the array passed
 * @param array $array
 * @return array
 **/
function CleanUpArrayOfInt($array)
{
    $result = array();
    if (isNullOrEmptyArray($array)) {
        return $result;
    }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627985" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>200</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[array_split_filter() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="195" end-line="205"><![CDATA[     * @param array $array
     * @param callable $callback
     * @return array
     * @see https://github.com/spatie/array-functions/blob/master/src/array_functions.php
     */
    function array_split_filter(array $array, callable $callback)
    {
        $passesFilter = array_filter($array, $callback);
        $negatedCallback = function ($item) use ($callback) {
            return !$callback($item);
        };]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628166" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>227</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[in_array_column() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="222" end-line="232"><![CDATA[     * @param string $column Column to perform search
     * @param bool $strict Should search be strict or not.
     * @return bool True if value exists in array, False otherwise.
     * @see modified from https://github.com/wapmorgan/php-functions-repository/blob/master/i/in_array_column.php
     */
    function in_array_column($haystack, $needle, $column, $strict = false)
    {
        foreach ($haystack as $k => $elem) {
            if ((!$strict && $elem[$column] == $needle) || ($strict && $elem[$column] === $needle)) {
                return true;
            }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628125" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>248</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[objectToArray() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="243" end-line="253"><![CDATA[     * @param $object
     *
     * @return array
     * @see https://github.com/ngfw/Recipe/blob/master/src/ngfw/Recipe.php
     */
    function objectToArray($object) : array
    {
        if (!is_object($object) && !is_array($object)) {
            return [];
        }
        if (is_object($object)) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628162" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>270</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[arrayToObject() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="265" end-line="275"><![CDATA[     * @param array $array PHP array
     *
     * @return stdClass (object)
     * @see https://github.com/ngfw/Recipe/blob/master/src/ngfw/Recipe.php
     */
    function arrayToObject(array $array = []) : \stdClass
    {
        $object = new \stdClass();

        if (!is_array($array) || count($array) < 1) {
            return $object;]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628209" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>300</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[arrayToString() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="295" end-line="305"><![CDATA[     * @param array $array array to convert to string
     *
     * @return string
     * @see https://github.com/ngfw/Recipe/blob/master/src/ngfw/Recipe.php
     */
    function arrayToString(array $array = []) : string
    {
        if (isNullOrEmptyArray($array)) {
            return '';
        }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627971" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>322</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[array_key_exists_safe() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="317" end-line="327"><![CDATA[     * Check if a key exists in array
     * @param array $array
     * @param string $key
     * @return bool
     */
    function array_key_exists_safe(array $array, string $key) : bool
    {
        if (isNullOrEmptyArray($array) || isNullOrEmpty($key)) {
            return false;
        }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628063" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>343</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[array_get_key_value_safe() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="338" end-line="348"><![CDATA[     * @param array $array
     * @param string $key
     * @param string $default
     * @return mixed
     */
    function array_get_key_value_safe(array $array, string $key, $default = null)
    {
        if (isNullOrEmptyArray($array) || isNullOrEmpty($key) || !array_key_exists($key, $array)) {
            return $default;
        }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628174" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>360</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isNullOrEmptyArray() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="355" end-line="365"><![CDATA[    /**
     * Check if array is null or empty.
     * @param $array
     * @return bool
     */
    function isNullOrEmptyArray($array):bool
    {
        return $array === null || !is_array($array) || count($array) < 1;
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628032" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>375</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isNullOrEmptyArrayKey() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="370" end-line="380"><![CDATA[     * @param $array
     * @param string $key
     * @param bool $withTrim if set to true (default) check if trim()!='' too.
     * @return bool
     */
    function isNullOrEmptyArrayKey(array $array, string $key, bool $withTrim = true):bool
    {
        return !array_key_exists_safe($array, $key) || $array[$key] === null || isNullOrEmpty($array[$key], $withTrim);
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628057" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>388</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isNotNullOrEmptyArray() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="383" end-line="393"><![CDATA[    /**
     * Check if array is not null and not empty.
     * @param $array
     * @return bool
     */
    function isNotNullOrEmptyArray($array):bool
    {
        return !isNullOrEmptyArray($array);
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627987" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>403</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isNotNullOrEmptyArrayKey() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="398" end-line="408"><![CDATA[     * @param $array
     * @param string $key
     * @param bool $withTrim if set to true (default) check if trim()!='' too.
     * @return bool
     */
    function isNotNullOrEmptyArrayKey(array $array, string $key, bool $withTrim = true):bool
    {
        return !isNullOrEmptyArrayKey($array, $key, $withTrim);
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628016" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>417</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[array_remove_columns() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="412" end-line="422"><![CDATA[     * Remove given column from the subarrays of a two dimensional array.
     * @param $array
     * @param int $columnToRemove
     * @return array
     */
    function array_remove_columns(array $array, int $columnToRemove):array
    {
        if (count($array) < 1) {
            return [];
        }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628149" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>456</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[array_remove_first_columns() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="451" end-line="461"><![CDATA[    /**
     * Remove first column from the subarrays of a two dimensional array.
     * @param $array
     * @return array
     */
    function array_remove_first_columns(array $array):array
    {
        return array_remove_columns($array, 1);
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628184" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>469</line>
      <resource><![CDATA[src/array.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[array_remove_last_columns() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="464" end-line="474"><![CDATA[    /**
     * Remove last column from the subarrays of a two dimensional array.
     * @param $array
     * @return array
     */
    function array_remove_last_columns(array $array):array
    {
        if (count($array) < 1) {
            return [];
        }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627991" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>159</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[carbonFromIsoDateTime() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="154" end-line="164"><![CDATA[/**
 * Get Carbon istance by string $date in 'Y-m-d H:i:s' format.
 * @param string $date
 * @return \Carbon\Carbon
 */
function carbonFromIsoDateTime(string $date): Carbon\Carbon
{
    return Carbon\Carbon::createFromFormat(DATE_TIME_FORMAT_ISO, $date);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628011" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>169</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[carbonFromIsoDate() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="164" end-line="174"><![CDATA[/**
 * Get Carbon istance by string $date in 'Y-m-d' format.
 * @param string $date
 * @return \Carbon\Carbon
 */
function carbonFromIsoDate(string $date): Carbon\Carbon
{
    return Carbon\Carbon::createFromFormat(DATE_FORMAT_ISO, $date);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628196" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>179</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[carbonFromItaDateTime() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="174" end-line="184"><![CDATA[/**
 * Get Carbon istance by string $date in 'd/m/Y H:i:s' format.
 * @param string $date
 * @return \Carbon\Carbon
 */
function carbonFromItaDateTime(string $date): Carbon\Carbon
{
    return Carbon\Carbon::createFromFormat(DATE_TIME_FORMAT_ITA, $date);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628004" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>189</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[carbonFromItaDate() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="184" end-line="194"><![CDATA[/**
 * Get Carbon istance by string $date in 'd/m/Y' format.
 * @param string $date
 * @return \Carbon\Carbon
 */
function carbonFromItaDate(string $date): Carbon\Carbon
{
    return Carbon\Carbon::createFromFormat(DATE_FORMAT_ITA, $date);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628179" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>201</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[carbon() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="196" end-line="206"><![CDATA[ * If $date string doesn't match passed forma, return Carbon::create().
 * @param string $date
 * @param string $format
 * @return \Carbon\Carbon
 */
function carbon(string $date, string $format = DATE_TIME_FORMAT_ISO): Carbon\Carbon
{
    return Carbon\Carbon::createFromFormat($format, $date);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628161" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>212</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[roman_year() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="207" end-line="217"><![CDATA[ * int to roman number
 * @param int|null $year
 * @return string
 * @see https://github.com/spatie-custom/blender/blob/master/app/Foundation/helpers.php
 */
function roman_year(int $year = null): string
{
    if (!is_numeric($year)) {
        $year = (int)date('Y');
    }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628156" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>258</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[partialsDateIso() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="253" end-line="263"><![CDATA[ * If $segment is not valid set to 'y'.
 * @param string $date
 * @param string $segment allowed value: d, giorno, m, mese, Y, anno
 * @return string
 */
function partialsDateIso(string $date, string $segment = 'Y') : string
{
    if (isNullOrEmpty($segment)) {
        $segment = 'Y';
    }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628082" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>290</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[dateIsoToIta() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="285" end-line="295"><![CDATA[ * Funzione per trasformare la data da Iso a italiano
 * If date is invalid return '00/00/0000'.
 * @param string $date
 * @return string
 */
function dateIsoToIta(string $date = "") : string
{
    if (isNullOrEmpty($date) || !isDateIso($date)) {
        return '00/00/0000';
    }
    $arr_data = preg_split('[-]', $date);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628158" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>305</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[dateItaToIso() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="300" end-line="310"><![CDATA[ * funzione per trasformare la data da italiano a Iso
 * If date is invalid return '0000-00-00'.
 * @param string $date
 * @return string
 */
function dateItaToIso(string $date = "") : string
{
    if (isNullOrEmpty($date) || !isDateIta($date)) {
        return '0000-00-00';
    }
    $arr_data = preg_split('/[\/.-]/', $date);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628038" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>321</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[monthFromNumber() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="316" end-line="326"><![CDATA[ * If $monthNumber if out of range, return empty string.
 * @param $monthNumber
 * @param bool $nameComplete if se to false (default) return the short form (Gen, Feb,...).
 * @return string
 */
function monthFromNumber(int $monthNumber, bool $nameComplete = false) : string
{
    if ($monthNumber < 1 || $monthNumber > 12) {
        return '';
    }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628202" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>337</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[dateIsoToItaSpec() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="332" end-line="342"><![CDATA[ * @param string $data
 * @param bool $ShowDayName
 * @param bool $ShortDayName
 * @return string
 */
function dateIsoToItaSpec(string $data = "", bool $ShowDayName = false, bool $ShortDayName = false) : string
{
    if (isNullOrEmpty($data) || !isDateIso($data)) {
        return "00/00/0000";
    } else {
        $arr_data = explode('-', $data);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627956" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>361</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getNameDayFromDateIso() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="356" end-line="366"><![CDATA[
/**
 * @param string $data
 * @return string
 */
function getNameDayFromDateIso(string $data) : string
{
    if (!isDateIso($data)) {
        return '';
    }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628207" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>378</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getTimeFromDateTimeIso() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="373" end-line="383"><![CDATA[
/**
 * @param string $dataTimeIso
 * @return string
 */
function getTimeFromDateTimeIso(string $dataTimeIso) : string
{
    if (!isDateTimeIso($dataTimeIso)) {
        return '00:00';
    }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628172" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>395</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[diff_in_year() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="390" end-line="400"><![CDATA[ * @param string $data1 date ('Y-m-d') or datetime ('Y-m-d H:i:s')
 * @param string $data2 date ('Y-m-d') or datetime ('Y-m-d H:i:s')
 *
 * @return int
 */
function diff_in_year($data1, $data2 = '') : int
{
    if (isNullOrEmpty($data1)) {
        return 0;
    }
    if (isNullOrEmpty($data2)) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627960" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>416</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[age() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="411" end-line="421"><![CDATA[ *
 * @param string $dateOfBirthday date ('Y-m-d') or datetime ('Y-m-d H:i:s') Date Of Birthday
 *
 * @return int
 */
function age($dateOfBirthday) : int
{
    return date_diff(date('Y-m-d'), $dateOfBirthday);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628023" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>431</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[ampm() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="426" end-line="436"><![CDATA[ *
 * @param   integer $hour number of the hour
 * @return  string
 * @see https://github.com/kohana/ohanzee-helpers/blob/master/src/Date.php
 */
function ampm($hour)
{
    // Always integer
    $hour = (int)$hour;
    return ($hour > 11) ? 'PM' : 'AM';
}]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628123" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>448</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[ampm2Number() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="443" end-line="453"><![CDATA[ * @param   integer $hour hour to adjust
 * @param   string $ampm AM or PM
 * @return  string
 * @see https://github.com/kohana/ohanzee-helpers/blob/master/src/Date.php
 */
function ampm2Number($hour, $ampm)
{
    $hour = (int)$hour;
    $ampm = strtolower($ampm);
    switch ($ampm) {
        case 'am':]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628139" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>484</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[fuzzySpan() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="479" end-line="489"><![CDATA[ * @param   integer $local_timestamp "local" timestamp, defaults to time()
 * @return  string $locale default 'IT' otherwise 'EN'
 * @return  string
 * @see https://github.com/kohana/ohanzee-helpers/blob/master/src/Date.php
 */
function fuzzySpan($timestamp, $local_timestamp = null, $locale = 'IT')
{
    $local_timestamp = ($local_timestamp === null) ? time() : (int)$local_timestamp;
    // Determine the difference in seconds
    $offset = abs($local_timestamp - $timestamp);
    if ($offset <= MINUTE_IN_SECOND) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628060" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>550</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[unixTimestamp2dos() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="545" end-line="555"><![CDATA[ *
 * @param   integer $timestamp UNIX timestamp
 * @return  integer
 * @see https://github.com/kohana/ohanzee-helpers/blob/master/src/Date.php
 */
function unixTimestamp2dos($timestamp = null)
{
    $timestamp = getdate($timestamp);
    if ($timestamp['year'] < 1980) {
        return (1 << 21 | 1 << 16);
    }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627986" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>575</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[dos2unixTimestamp() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="570" end-line="580"><![CDATA[ *
 * @param  integer|bool $timestamp DOS timestamp
 * @return  integer
 * @see https://github.com/kohana/ohanzee-helpers/blob/master/src/Date.php
 */
function dos2unixTimestamp($timestamp = false)
{
    $sec = 2 * ($timestamp & 0x1f);
    $min = ($timestamp >> 5) & 0x3f;
    $hrs = ($timestamp >> 11) & 0x1f;
    $day = ($timestamp >> 16) & 0x1f;]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628025" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>597</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[cal_days_in_month() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="592" end-line="602"><![CDATA[     * @param $calendar
     * @param int $month
     * @param int $year
     * @return int
     */
    function cal_days_in_month($calendar = CAL_GREGORIAN, $month, $year) : int
    {
        if (!isInRange($month, 1, 12) || $year < 1) {
            return 0;
        }
        $dim = date('t', mktime(0, 0, 0, $month, 1, $year));]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628088" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>616</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[cal_days_in_current_month() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="611" end-line="621"><![CDATA[     * in a current month in CAL_GREGORIAN calendar.
     * If $calendar is null or empty or not is integer, use CAL_GREGORIAN.
     * @param $calendar
     * @return int
     */
    function cal_days_in_current_month(int $calendar = CAL_GREGORIAN) : int
    {
        if (function_exists('cal_days_in_month')) {
            return (int)cal_days_in_month($calendar, date('m'), date('Y'));
        }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628002" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>633</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[days_in_month() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="628" end-line="638"><![CDATA[     * Return the number of days for a given month and year (using CAL_GREGORIAN calendar).
     * @param int $month
     * @param int $year
     * @return int
     */
    function days_in_month(int $month, int $year) : int
    {
        return cal_days_in_month(CAL_GREGORIAN, $month, $year);
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628091" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>644</line>
      <resource><![CDATA[src/datetime.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[days_in_current_month() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="639" end-line="649"><![CDATA[if (!function_exists('days_in_current_month')) {
    /**
     * Return the number of days in a current month (using CAL_GREGORIAN calendar).
     * @return int
     */
    function days_in_current_month() : int
    {
        return cal_days_in_current_month(CAL_GREGORIAN);
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628198" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>12</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[rgb2hex() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="7" end-line="17"><![CDATA[     * @param int $green
     * @param int $blue
     * @return string
     * @see https://gist.github.com/Pushplaybang/5432844
     */
    function rgb2hex(int $red, int $green, int $blue):  string
    {
        $hex = "#";
        $hex .= str_pad(dechex($red), 2, "0", STR_PAD_LEFT);
        $hex .= str_pad(dechex($green), 2, "0", STR_PAD_LEFT);
        $hex .= str_pad(dechex($blue), 2, "0", STR_PAD_LEFT);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628112" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>32</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[hex2rgb() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="27" end-line="37"><![CDATA[     *
     * @param string $color Color hex value, example: #000000, #000 or 000000, 000
     *
     * @return string color rbd value
     */
    function hex2rgb($color)
    {
        $color = str_replace('#', '', $color);
        if (strlen($color) == 3):
            list($r, $g, $b) = [$color[0] . $color[0], $color[1] . $color[1], $color[2] . $color[2]];
        else:]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627963" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>54</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[format_money() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="49" end-line="59"><![CDATA[ * @param int $precision
 * @param string $simbol
 * @param bool $prepend if true (default) prefix with $simbol, otherwise suffix with $simbol.
 * @return string
 */
function format_money(float $val = 0.00, int $precision = 2, string $simbol = "", bool $prepend=true) : string
{
    $prefix = $simbol.' ';
    $suffix = '';
    if(!$prepend){
        $prefix = '';]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627983" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>71</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[format_euro() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="66" end-line="76"><![CDATA[ * Format float 1125.86 into string '&euro 1.125,86'
 * @param float $val
 * @param bool $prepend if true (default) prefix with '&euro; ', otherwise suffix with ' &euro;'.
 * @return string
 */
function format_euro(float $val = 0.00, bool $prepend=true) : string
{
    return format_money($val, 2, '&euro; ', $prepend);
}

if (!function_exists('ordinal')) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628122" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>83</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[ordinal() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="78" end-line="88"><![CDATA[    /**
     * Given a number, return the number + 'th' or 'rd' etc
     * @param $cdnl
     * @return string
     */
    function ordinal($cdnl)
    {
        $test_c = abs($cdnl) % 10;
        $ext = ((abs($cdnl) % 100 < 21 && abs($cdnl) % 100 > 4) ? 'th'
            : (($test_c < 4) ? ($test_c < 3) ? ($test_c < 2) ? ($test_c < 1)
                ? 'th' : 'st' : 'nd' : 'rd' : 'th'));]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627961" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>100</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[value() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="95" end-line="105"><![CDATA[     * Return the default value of the given value.
     *
     * @param  mixed $value
     * @return mixed
     */
    function value($value)
    {
        return $value instanceof Closure ? $value() : $value;
    }
}
if (!function_exists('with')) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628102" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>112</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[with() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="107" end-line="117"><![CDATA[     * Return the given object. Useful for chaining.
     *
     * @param  mixed $object
     * @return mixed
     */
    function with($object)
    {
        return $object;
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628097" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>121</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[setErrorReportingForProduction() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="116" end-line="126"><![CDATA[}

/**
 * Set the default configuration of erro reporting for production.
 */
function setErrorReportingForProduction()
{
    if (version_compare(PHP_VERSION, '5.4.0') >= 0) {
        error_reporting(E_ALL & ~E_NOTICE & ~E_DEPRECATED & ~E_STRICT);
    } elseif (version_compare(PHP_VERSION, '5.3.0') >= 0) {
        error_reporting(E_ALL ^ E_NOTICE ^ E_DEPRECATED);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628137" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>136</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isExecutedByCLI() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="131" end-line="141"><![CDATA[
/**
 * Check if PHP script was executed by shell.
 * @return bool
 */
function isExecutedByCLI() : bool
{
    return php_sapi_name() == 'cli';
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628163" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>148</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[bytes2HumanSize() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="143" end-line="153"><![CDATA[ * to a nice format with PB, TB, GB, MB, kB, bytes.
 * @param $bytes
 * @param int $decimals [optional] default 0. Sets the number of decimal points.
 * @return string
 */
function bytes2HumanSize($bytes, $decimals=0)
{
    if(!isIntegerPositiveOrZero($decimals)){
        $decimals = 0;
    }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627954" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>181</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[convertPHPSizeToBytes() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="176" end-line="186"><![CDATA[ * This function transforms the php.ini notation for numbers (like '2M')
 * to an integer (2*1024*1024 in this case)
 * @param string $sSize
 * @return int|string
 */
function convertPHPSizeToBytes($sSize)
{
    if (is_numeric($sSize)) {
        return $sSize;
    }
    $sSuffix = substr($sSize, -1);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628159" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>215</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getMaximumFileUploadSize() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="210" end-line="220"><![CDATA[/**
 * Return the Max upload size in bytes.
 * @param bool $humanFormat if set to true return size in human format (MB, kB, etc..) otherwise return in bytes.
 * @return int
 */
function getMaximumFileUploadSize(bool $humanFormat = false)
{
    $size = min(convertPHPSizeToBytes(ini_get('post_max_size')), convertPHPSizeToBytes(ini_get('upload_max_filesize')));

    if (!$humanFormat) {
        return $size;]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627959" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>232</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[encryptString() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="227" end-line="237"><![CDATA[ * Encrypt string in asymmetrical way.
 * @param string $string to encrypt.
 * @param string $chiave the key to encrypt. if empty generate a random key on the fly.
 * @return string
 */
function encryptString(string $string, string $chiave = '')
{
    if ($chiave == '') {
        $chiave = str_random(64);
    }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628173" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>269</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getFaviconUrl() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="264" end-line="274"><![CDATA[ * @param string $url website url
 *
 * @return string containing complete image tag
 * @see https://github.com/ngfw/Recipe/blob/master/src/ngfw/Recipe.php
 */
function getFaviconUrl($url) : string
{
    $apiUrl = 'https://www.google.com/s2/favicons?domain=';
    if (strpos($url, 'http') !== false) {
        $url = str_replace('http://', '', $url);
    }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627994" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>287</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getFaviconImgTag() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="282" end-line="292"><![CDATA[ * @param array $attributes Optional, additional key/value attributes to include in the IMG tag
 *
 * @return string containing complete image tag
 * @see https://github.com/ngfw/Recipe/blob/master/src/ngfw/Recipe.php
 */
function getFaviconImgTag($url, array $attributes = []) : string
{
    $urlFav = getFaviconUrl($url);
    $attr = arrayToString($attributes);
    return '<img src="' . $urlFav . '" ' . trim($attr) . ' />';
}]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628154" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>300</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isHttps() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="295" end-line="305"><![CDATA[ * Check to see if the current page is being server over SSL or not.
 * Support HTTP_X_FORWARDED_PROTO to check ssl over proxy/load balancer.
 *
 * @return bool
 */
function isHttps()
{
    $key = 'HTTPS';
    if (isNotNullOrEmptyArrayKey($_SERVER, 'HTTP_X_FORWARDED_PROTO')) {
        $key = 'HTTP_X_FORWARDED_PROTO';
    }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628142" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>320</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getQRcode() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="315" end-line="325"><![CDATA[ * @param array $attributes Optional, additional key/value attributes to include in the IMG tag
 *
 * @return string containing complete image tag
 * @see https://github.com/ngfw/Recipe/blob/master/src/ngfw/Recipe.php
 */
function getQRcode($string, int $width = 150, int $height = 150, array $attributes = []) : string
{
    $attr = arrayToString($attributes);
    $apiUrl = getQRcodeUrl($string, $width, $height);
    return '<img src="' . $apiUrl . '" ' . trim($attr) . ' />';
}]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628036" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>337</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getQRcodeUrl() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="332" end-line="342"><![CDATA[ * @param int $height QR code height
 *
 * @return string containing complete image url
 * @see https://github.com/ngfw/Recipe/blob/master/src/ngfw/Recipe.php
 */
function getQRcodeUrl($string, int $width = 150, int $height = 150) : string
{
    $protocol = 'http://';
    if (isHttps()) {
        $protocol = 'https://';
    }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628111" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>357</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[gravatarUrl() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="352" end-line="362"><![CDATA[     * @param string $default imageset to use [ 404 | mm | identicon | monsterid | wavatar ]
     * @param string $rating (inclusive) [ g | pg | r | x ]
     * @return string
     * @source http://gravatar.com/site/implement/images/php/
     */
    function gravatarUrl($email, $size = 80, $default = 'mm', $rating = 'g')
    {
        $url = 'https://www.gravatar.com';
        $url .= '/avatar/' . md5(strtolower(trim($email))) . '?default=' . $default . '&size=' . $size . '&rating=' . $rating;
        return $url;
    }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628104" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>377</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[gravatar() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="372" end-line="382"><![CDATA[     * @param string $rating (inclusive) [ g | pg | r | x ]
     * @param array $attributes Optional, additional key/value attributes to include in the IMG tag
     * @return string
     * @source http://gravatar.com/site/implement/images/php/
     */
    function gravatar($email, $size = 80, $default = 'mm', $rating = 'g', $attributes = [])
    {
        $attr = arrayToString($attributes);
        $url = gravatarUrl($email, $size, $default, $rating);
        return '<img src="' . $url . '" width="' . $size . 'px" height="' . $size . 'px" ' . trim($attr) . ' />';
    }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627976" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>392</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isAjax() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="387" end-line="397"><![CDATA[    /**
     * Determine if current page request type is ajax.
     *
     * @return bool
     */
    function isAjax()
    {
        return isNotNullOrEmptyArrayKey($_SERVER, 'HTTP_X_REQUESTED_WITH')
        && strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) == 'xmlhttprequest';
    }
}]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628062" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>409</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isNumberOdd() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="404" end-line="414"><![CDATA[     * @param int $num integer to check
     *
     * @return bool
     * @see https://github.com/ngfw/Recipe/blob/master/src/ngfw/Recipe.php
     */
    function isNumberOdd($num)
    {
        return $num % 2 !== 0;
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628100" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>425</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isNumberEven() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="420" end-line="430"><![CDATA[     * @param int $num integer to check
     *
     * @return bool
     * @see https://github.com/ngfw/Recipe/blob/master/src/ngfw/Recipe.php
     */
    function isNumberEven($num)
    {
        return $num % 2 == 0;
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628206" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>439</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getCurrentUrlPageName() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="434" end-line="444"><![CDATA[     * Returns The Current URL PHP File Name.
     * Ex.: http://www.dummy.com/one/two/index.php?one=1&two=2 return index.php
     *
     * @return string
     */
    function getCurrentUrlPageName() : string
    {
        return isNotNullOrEmptyArrayKey($_SERVER, 'PHP_SELF') ? basename($_SERVER['PHP_SELF']) : '';
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628119" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>453</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getCurrentUrlQuerystring() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="448" end-line="458"><![CDATA[     * Returns The Current URL querystring.
     * Ex.: http://www.dummy.com/one/two/index.php?one=1&two=2 return one=1&two=2
     *
     * @return string
     */
    function getCurrentUrlQuerystring() : string
    {
        return isNotNullOrEmptyArrayKey($_SERVER, 'QUERY_STRING') ? $_SERVER['QUERY_STRING'] : '';
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628107" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>467</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getCurrentUrlDirName() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="462" end-line="472"><![CDATA[     * Returns The Current URL Path Name.
     * Ex.: http://www.dummy.com/one/two/index.php?one=1&two=2 return /one/two
     *
     * @return string
     */
    function getCurrentUrlDirName() : string
    {
        if (isNotNullOrEmptyArrayKey($_SERVER, 'REQUEST_URI')) {
            return dirname($_SERVER['REQUEST_URI']);
        }
        return isNotNullOrEmptyArrayKey($_SERVER, 'PHP_SELF') ? dirname($_SERVER['PHP_SELF']) : '';]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628186" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>484</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getCurrentUrlDirAbsName() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="479" end-line="489"><![CDATA[     * Returns The Current URL Absolute Path Name.
     * Ex.: http://www.dummy.com/one/two/index.php?one=1&two=2 return /home/user/www/one/two
     *
     * @return string
     */
    function getCurrentUrlDirAbsName() : string
    {
        return isNotNullOrEmptyArrayKey($_SERVER, 'SCRIPT_FILENAME') ? dirname($_SERVER['SCRIPT_FILENAME']) : '';
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628143" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>500</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getCurrentURL() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="495" end-line="505"><![CDATA[     * Or
     * Ex.: https://username:passwd@www.dummy.com:443/one/two/index.php?one=1&two=2
     * @return string
     * @see https://github.com/ngfw/Recipe/blob/master/src/ngfw/Recipe.php
     */
    function getCurrentURL()
    {
        $url = 'http://';
        if (isHttps()) {
            $url = 'https://';
        }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628001" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>538</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isMobile() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="533" end-line="543"><![CDATA[    /**
     * Detect if user is on mobile device.
     *
     * @return bool
     */
    function isMobile()
    {
        $useragent = $_SERVER['HTTP_USER_AGENT'];
        return preg_match('/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i',
            $useragent)
        || preg_match('/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i',]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628005" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>554</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getBrowser() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="549" end-line="559"><![CDATA[ * Get user browser.
 *
 * @return string
 * @see https://github.com/ngfw/Recipe/blob/master/src/ngfw/Recipe.php
 */
function getBrowser()
{
    $u_agent = $_SERVER['HTTP_USER_AGENT'];
    $browserName = $ub = $platform = 'Unknown';
    if (preg_match('/linux/i', $u_agent)) {
        $platform = 'Linux';]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628059" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>610</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getTinyUrl() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="605" end-line="615"><![CDATA[ * It support http or https.
 * @param string $url URL to shorten
 *
 * @return string shortend url or empty string if it fails.
 */
function getTinyUrl(string $url) : string
{
    if (!starts_with($url, 'http')) {
        $url = (isHttps() ? 'https://' : 'http://') . $url;
    }
    $gettiny = curl('http://tinyurl.com/api-create.php?url=' . $url);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628041" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>633</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[expandShortUrl() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="628" end-line="638"><![CDATA[ * @param string $shortURL shortened URL
 *
 * @return string full url or empty string
 * @see https://github.com/ngfw/Recipe/blob/master/src/ngfw/Recipe.php
 */
function expandShortUrl(string $shortURL) : string
{
    if (isNullOrEmpty($shortURL)) {
        return '';
    }
    $headers = get_headers($shortURL, 1);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628180" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>691</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[curl() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="686" end-line="696"><![CDATA[     * and ignore $returnInfo (i.e. call curl_getinfo even if $returnInfo is set to false).
     *
     * @return string|array if $returnInfo is set to True, array is returned with two keys, contents (will contain response) and info (information regarding a specific transfer), otherwise response content is returned
     * @see https://github.com/ngfw/Recipe/blob/master/src/ngfw/Recipe.php
     */
    function curl(
        $url,
        $method = 'GET',
        $data = false,
        array $headers = [],
        bool $returnInfo = false,]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628056" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>849</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[curl_internal_server_behind_load_balancer() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="844" end-line="854"><![CDATA[     * @param string $userAgent default 'Mozilla/5.0 (Windows NT 6.2; WOW64; rv:17.0) Gecko/20100101 Firefox/17.0'
     * and ignore $returnInfo (i.e. call curl_getinfo even if $returnInfo is set to false).
     *
     * @return string|array if $returnInfo is set to True, array is returned with two keys, contents (will contain response) and info (information regarding a specific transfer), otherwise response content is returned
     */
    function curl_internal_server_behind_load_balancer(
        $url,
        $server_name = '',
        $localServerIpAddress = '',
        $method = 'GET',
        $data = false,]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628210" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>905</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[startLayoutCapture() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="900" end-line="910"><![CDATA[
    /**
     * Turn On the output buffering.
     * @return bool
     */
    function startLayoutCapture() : bool
    {
        return ob_start();
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628053" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>917</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[endLayoutCapture() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="912" end-line="922"><![CDATA[
    /**
     * Get the buffer contents for the topmost buffer and clean it.
     * @return string
     */
    function endLayoutCapture() : string
    {
        $data = ob_get_contents();
        ob_end_clean();
        return $data === false ? '' : $data;
    }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627999" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>932</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[get_var_dump_output() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="927" end-line="937"><![CDATA[    /**
     * Capture var dump $var output and return it.
     * @param $var
     * @return string
     */
    function get_var_dump_output($var)
    {
        startLayoutCapture();
        $myfunc = "var_dump";
        $myfunc($var);
        return endLayoutCapture();]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627972" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>951</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[debug() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="946" end-line="956"><![CDATA[     * @param mixed $variable Variable to debug
     *
     * @return void
     * @see https://github.com/ngfw/Recipe/blob/master/src/ngfw/Recipe.php
     */
    function debug($variable)
    {
        $output = get_var_dump_output($variable);
        $maps = [
            'string' => "/(string\((?P<length>\d+)\)) (?P<value>\"(?<!\\\).*\")/i",
            'array' => "/\[\"(?P<key>.+)\"(?:\:\"(?P<class>[a-z0-9_\\\]+)\")?(?:\:(?P<scope>public|protected|private))?\]=>/Ui",]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628146" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1011</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getReferer() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1006" end-line="1016"><![CDATA[    /**
     * Return referer page if exists otherwise return empty string.
     *
     * @return string
     */
    function getReferer() : string
    {
        return isNotNullOrEmptyArrayKey($_SERVER, 'HTTP_REFERER') ? $_SERVER['HTTP_REFERER'] : '';
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628010" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1023</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isZlibOutputCompressionActive() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1018" end-line="1028"><![CDATA[
    /**
     * Check if zlib output compression was active
     * @return bool
     */
    function isZlibOutputCompressionActive() : bool
    {
        return ini_get('zlib.output_compression') == 'On'
        || ini_get('zlib.output_compression_level') > 0
        || ini_get('output_handler') == 'ob_gzhandler';
    }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628132" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1037</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isZlibLoaded() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1032" end-line="1042"><![CDATA[
    /**
     * Check if zlib extension was loaded
     * @return bool
     */
    function isZlibLoaded() : bool
    {
        return extension_loaded('zlib');
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628075" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1049</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isClientAcceptGzipEncoding() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1044" end-line="1054"><![CDATA[
    /**
     * Check if client accept gzip encoding
     * @return bool
     */
    function isClientAcceptGzipEncoding() : bool
    {
        return isNotNullOrEmptyArrayKey($_SERVER, 'HTTP_ACCEPT_ENCODING')
        && strpos($_SERVER['HTTP_ACCEPT_ENCODING'], 'gzip') !== false;
    }
}]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628208" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1065</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[compressHtmlPage() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1060" end-line="1070"><![CDATA[     * removes whitespace from captured output and echos back
     *
     * @return string whitespace stripped output
     * @see https://github.com/ngfw/Recipe/
     */
    function compressHtmlPage() : string
    {
        register_shutdown_function(function () {
            $buffer = str_html_compress(ob_get_contents());
            ob_end_clean();
            if (!isZlibOutputCompressionActive() &&]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628164" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1088</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[get_http_response_code() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1083" end-line="1093"><![CDATA[    /**
     * @param string $theURL
     * @param bool $useGet if set to true use a GET request, otherwise use a HEAD request (more fast).
     * @return int return the http status or 999 if it fails.
     */
    function get_http_response_code(string $theURL, bool $useGet = false) : int
    {
        if (isNullOrEmpty($theURL)) {
            return 999;
        }
        if (!$useGet) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628170" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1121</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[url_exists() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1116" end-line="1126"><![CDATA[    /**
     * Check if URL exists (return http status code <400
     * @param string $url
     * @return bool
     */
    function url_exists(string $url) : bool
    {
        return get_http_response_code($url) < 400;
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628215" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1136</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[logToFile() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1131" end-line="1141"><![CDATA[     * @param string $pathFile full path with file name.
     * @param mixed $value value to log
     * @param bool $varDump default false. if set to true,
     * grab var dump output of $value and write it to log, otherwise append it to log.
     */
    function logToFile(string $pathFile, $value, bool $varDump = false)
    {
        if ($varDump) {
            $value = get_var_dump_output($value);
        }
        $f = fopen($pathFile, 'ab');]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628218" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1153</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isImageExtension() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1148" end-line="1158"><![CDATA[ * Check if an extension is an image type.
 * @param  string $ext extension to check
 * @return boolean
 * @see https://github.com/kohana/ohanzee-helpers/blob/master/src/Mime.php
 */
function isImageExtension(string $ext) : bool
{
    return in_array(strtolower($ext), getImageExtensions());
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628079" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1163</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getImageExtensions() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1158" end-line="1168"><![CDATA[/**
 * Get a list of common image extensions. Only types that can be read by
 * PHP's internal image methods are included!
 * @return string[]
 */
function getImageExtensions() : array
{
    return [
        'bmp',
        'gif',
        'jpeg',]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628064" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1192</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[template() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1187" end-line="1197"><![CDATA[ * @example
 * <?php
 * $result = template('This is the best template parser. Created by {developerName}', ['developerName' => 'Radic']);
 * echo $result; // This is the best template parser. Created by Radic
 */
function template($str, array $vars = [], $openDelimiter = '{', $closeDelimiter = '}')
{
    foreach ($vars as $k => $var) {
        if (is_array($var)) {
            $str = template($str, $var);
        } elseif (is_string($var)) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628052" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1209</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[randomChance() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1204" end-line="1214"><![CDATA[/**
 * @param int $percent
 * @return bool
 * @see https://github.com/laradic/support/blob/master/src/Util.php
 */
function randomChance(int $percent = 50) : bool
{
    return random_int(0, 100) > 100 - $percent;
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628007" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1218</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getExceptionTraceAsString() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1213" end-line="1223"><![CDATA[
/**
 * @param Throwable $exception
 * @return string
 */
function getExceptionTraceAsString(\Throwable $exception)
{
    $rtn = "";
    $count = 0;
    foreach ($exception->getTrace() as $frame) {
        $args = "";]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628067" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1264</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[windows_os() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1259" end-line="1269"><![CDATA[     *
     * @return bool
     *
     * @see https://github.com/illuminate/support/blob/master/helpers.php
     */
    function windows_os() : bool
    {
        return strtolower(substr(PHP_OS, 0, 3)) === 'win';
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628133" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1280</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getConsoleColorTagForStatusCode() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1275" end-line="1285"><![CDATA[     *
     * @return string
     *
     * @see https://github.com/spatie/http-status-check/blob/master/src/CrawlLogger.php#L96
     */
    function getConsoleColorTagForStatusCode($code)
    {
        if (starts_with($code, '2')) {
            return 'info';
        }
        if (starts_with($code, '3')) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628138" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1300</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[is_32bit() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1295" end-line="1305"><![CDATA[     *
     * @return bool
     *
     * @see http://stackoverflow.com/questions/6303241/find-windows-32-or-64-bit-using-php
     */
    function is_32bit() : bool
    {
        return get_os_architecture()==32;
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628195" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1314</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[is_64bit() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1309" end-line="1319"><![CDATA[     *
     * @return bool
     *
     * @see http://stackoverflow.com/questions/6303241/find-windows-32-or-64-bit-using-php
     */
    function is_64bit() : bool
    {
        return get_os_architecture()==64;
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628093" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1328</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[get_os_architecture() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1323" end-line="1333"><![CDATA[     *
     * @return int return 32 or 64 if ok, otherwise return 0.
     *
     * @see http://stackoverflow.com/questions/6303241/find-windows-32-or-64-bit-using-php
     */
    function get_os_architecture() : int
    {
        switch(PHP_INT_SIZE) {
            case 4:
                return 32;
            case 8:]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628068" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1349</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isRequestFromCloudFlare() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1344" end-line="1354"><![CDATA[    /**
     * Check if request (by given $_SERVER) is a cloudflare request
     * @param $server
     * @return bool
     */
    function isRequestFromCloudFlare(array $server) : bool
    {
        if (!isset($server['HTTP_CF_CONNECTING_IP']) || !isIP($server['HTTP_CF_CONNECTING_IP'])) {
            return false;
        }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628114" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1395</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isCloudFlareIp() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1390" end-line="1400"><![CDATA[    /**
     * Check if given ip is a valid cloudflare ip.
     * @param $ip
     * @return bool
     */
    function isCloudFlareIp($ip) : bool
    {
        if (!isIP($ip)) {
            return false;
        }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628043" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1442</line>
      <resource><![CDATA[src/helpers.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[gzCompressFile() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1437" end-line="1447"><![CDATA[     *
     * @param string $source Path to file that should be compressed
     * @param integer $level GZIP compression level (default: 9)
     * @return string New filename (with .gz appended) if success, or false if operation fails
     */
    function gzCompressFile($source, $level = 9)
    {
        $dest = $source . '.gz';
        $mode = 'wb' . $level;
        $error = false;
        if ($fp_out = gzopen($dest, $mode)) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=new#551628026" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>10</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getIPVisitor() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="5" end-line="15"><![CDATA[ * @param array $server
 * @return string
 * @deprecated
 * @see getClientIp();
 */
function getIPVisitor(array $server = []) : string
{
    $IP2Check = '';
    if (array_key_exists('HTTP_X_FORWARDED_FOR', $server) && trim($server['HTTP_X_FORWARDED_FOR']) != '') {
        $IP2Check = $server['HTTP_X_FORWARDED_FOR'];
    } elseif (array_key_exists('REMOTE_ADDR', $server) && trim($server['REMOTE_ADDR'])) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628039" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>40</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[anonimizeIp() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="35" end-line="45"><![CDATA[ * With bad ip argument return 0.0.0.0
 * Support IPv4, Ipv6 and IPv4 Compatibility.
 * @param  string $ip
 * @return string  masked IP
 */
function anonimizeIp(string $ip) : string
{
    if (isIPv4($ip)) {
        return anonimizeIpv4($ip);
    } elseif (isIPv4Compatibility($ip)) {
        return anonimizeIpv4Compatibility($ip);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628191" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>56</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[anonimizeIpv4Compatibility() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="51" end-line="61"><![CDATA[ * masquerade last digit of IP address.
 * With bad ip argument return 0.0.0.0
 * @param string $ip
 * @return string
 */
function anonimizeIpv4Compatibility(string $ip):string
{
    if (isIPv4Compatibility($ip)) {
        return substr($ip, 0, strrpos($ip, ".") + 1) . '0';
    }
    return '0.0.0.0';]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628188" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>70</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[anonimizeIpWithInet() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="65" end-line="75"><![CDATA[ * masquerade last digit of IP address with inet php functions.
 * With bad ip argument return 0.0.0.0
 * @param string $ip
 * @return string
 */
function anonimizeIpWithInet(string $ip):string
{
    if ($ip = @inet_pton($ip)) {
        return inet_ntop(substr($ip, 0, strlen($ip) / 2) . str_repeat(chr(0), strlen($ip) / 2));
    }
    return '0.0.0.0';]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628160" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>84</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[anonimizeIpv6() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="79" end-line="89"><![CDATA[ * masquerade last digit of IP address.
 * With bad ip argument return 0.0.0.0
 * @param string $ip
 * @return string
 */
function anonimizeIpv6(string $ip):string
{
    if (strrpos($ip, ":") > 0) {
        return substr($ip, 0, strrpos($ip, ":") + 1) . '0';
    }
    return '0.0.0.0';]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628030" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>98</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[anonimizeIpv4() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="93" end-line="103"><![CDATA[ * masquerade last digit of IP address.
 * With bad ip argument return 0.0.0.0
 * @param string $ip
 * @return string
 */
function anonimizeIpv4(string $ip):string
{
    if (isIPv4($ip)) {
        return substr($ip, 0, strrpos($ip, ".") + 1) . '0';
    }
    return '0.0.0.0';]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628130" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>113</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getHost() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="108" end-line="118"><![CDATA[ * @param  string $ip the IP to resolve.
 * @return string    Returns the host name of the Internet host specified by ip_address on success,
 *                   the unmodified ip_address on failure,
 *                   or FALSE on malformed input.
 */
function getHost($ip)
{
    return gethostbyaddr($ip);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628211" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>136</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getClientIps() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="131" end-line="141"><![CDATA[ * @return array The client IP addresses
 *
 * @see getClientIp()
 * @see https://github.com/symfony/symfony/blob/0b39ce23150c34c990e3eccfae4e375161c0d352/src/Symfony/Component/HttpFoundation/Request.php#L831
 */
function getClientIps(array $server, array $trustedProxies = []) : array
{
    if (empty($server)) {
        return [''];
    }
    $clientIps = array();]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628177" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>191</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getClientIp() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="186" end-line="196"><![CDATA[ * @see getClientIps()
 * @see https://github.com/symfony/symfony/blob/0b39ce23150c34c990e3eccfae4e375161c0d352/src/Symfony/Component/HttpFoundation/Request.php#L886
 * @see http://en.wikipedia.org/wiki/X-Forwarded-For
 *
 */
function getClientIp(array $server, array $trustedProxies = []) : string
{
    $ipAddresses = getClientIps($server, $trustedProxies);
    return $ipAddresses[0];
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628212" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>206</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[checkIp() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="201" end-line="211"><![CDATA[ * @param string|array $ips List of IPs or subnets (can be a string if only a single one)
 *
 * @return bool Whether the IP is valid
 * @see https://github.com/symfony/http-foundation/blob/master/IpUtils.php
 */
function checkIp($requestIp, $ips) : bool
{
    if (empty($ips)) {
        return false;
    }
    if (!is_array($ips)) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628094" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>233</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[checkIp4() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="228" end-line="238"><![CDATA[ * @param string $ip IPv4 address or subnet in CIDR notation
 *
 * @return bool Whether the request IP matches the IP, or whether the request IP is within the CIDR subnet
 * @see https://github.com/symfony/http-foundation/blob/master/IpUtils.php
 */
function checkIp4($requestIp, $ip) : bool
{
    if (false !== strpos($ip, '/')) {
        list($address, $netmask) = explode('/', $ip, 2);
        if ($netmask === '0') {
            // Ensure IP is valid - using ip2long below implicitly validates, but we need to do it manually here]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628078" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>268</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[checkIp6() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="263" end-line="273"><![CDATA[ *
 * @return bool Whether the IP is valid
 *
 * @throws \RuntimeException When IPV6 support is not enabled
 */
function checkIp6($requestIp, $ip) : bool
{
    if (!((extension_loaded('sockets') && defined('AF_INET6')) || @inet_pton('::1'))) {
        throw new \RuntimeException('Unable to check Ipv6. Check that PHP was not compiled with option "disable-ipv6".');
    }
    if (false !== strpos($ip, '/')) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627966" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>304</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isFromTrustedProxy() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="299" end-line="309"><![CDATA[ * Check if $ip is contained in $trustedProxies array.
 * @param array $trustedProxies
 * @param $ip
 * @return bool
 */
function isFromTrustedProxy(array $trustedProxies, $ip)
{
    return !empty($trustedProxies) && checkIp($ip, $trustedProxies);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628061" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>316</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[iPv4To6() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="311" end-line="321"><![CDATA[ *
 * @param string IP Address in dot notation (192.168.1.100)
 * @return string IPv6 formatted address or false if invalid input
 * @see http://stackoverflow.com/questions/444966/working-with-ipv6-addresses-in-php
 */
function iPv4To6($ip)
{
    static $Mask = '::ffff:'; // This tells IPv6 it has an IPv4 address
    $IPv6 = (strpos($ip, '::') === 0);
    $IPv4 = (strpos($ip, '.') > 0);
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628022" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>353</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[expandIPv6Notation() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="348" end-line="358"><![CDATA[ * Replace '::' with appropriate number of ':0'
 * @param $ip
 * @return mixed|string
 * @see http://stackoverflow.com/questions/12095835/quick-way-of-expanding-ipv6-addresses-with-php
 */
function expandIPv6Notation($ip)
{
    if (!iPv4To6($ip)) {
        return $ip;
    }
    $hex = unpack("H*hex", inet_pton($ip));]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628205" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>372</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[decbin32() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="367" end-line="377"><![CDATA[ * with zeros out to 32 characters - IP addresses are 32 bit numbers
 *
 * @param $dec
 * @return string
 */
function decbin32 ($dec)
{
    return str_pad(decbin($dec), 32, '0', STR_PAD_LEFT);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628187" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>413</line>
      <resource><![CDATA[src/ip.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[ipInRange() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="408" end-line="418"><![CDATA[ *
 * @param $ip
 * @param $range Network ranges can be specified as: 1. Wildcard format 1.2.3.*, 2. CIDR format: 1.2.3/24  OR  1.2.3.4/255.255.255.0, 3. Start-End IP format 1.2.3.0-1.2.3.255
 * @return bool The function will return true if the supplied IP is within the range.
 */
function ipInRange($ip, $range) : bool
{
    if(!is_string($ip) || !is_string($range)){
        return false;
    }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627996" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>9</line>
      <resource><![CDATA[src/reflection.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[short_class_name() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="4" end-line="14"><![CDATA[
    /**
     * @param $object
     * @return string
     */
    function short_class_name($object): string
    {
        $objectProperties = new \ReflectionClass($object);

        return $objectProperties->getShortName();
    }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628084" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>27</line>
      <resource><![CDATA[src/reflection.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[class_constants() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="22" end-line="32"><![CDATA[     * @param $object
     * @param string $startsWithFilter
     * @return array
     * @see https://github.com/spatie-custom/blender/blob/master/app/Foundation/helpers.php
     */
    function class_constants($object, string $startsWithFilter = ''): array
    {
        $objectProperties = new \ReflectionClass($object);

        $constants = $objectProperties->getConstants();
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628135" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>50</line>
      <resource><![CDATA[src/reflection.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[class_uses_recursive() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="45" end-line="55"><![CDATA[     * Returns all traits used by a class, it's subclasses and trait of their traits
     *
     * @param  string $class
     * @return array
     */
    function class_uses_recursive($class)
    {
        $results = [];
        foreach (array_merge([$class => $class], class_parents($class)) as $class) {
            $results += trait_uses_recursive($class);
        }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627988" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>67</line>
      <resource><![CDATA[src/reflection.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[class_basename() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="62" end-line="72"><![CDATA[     * Get the class "basename" of the given object / class.
     *
     * @param  string|object $class
     * @return string
     */
    function class_basename($class)
    {
        $class = is_object($class) ? get_class($class) : $class;
        return basename(str_replace('\\', '/', $class));
    }
}]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628051" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>82</line>
      <resource><![CDATA[src/reflection.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getClassNameFromFile() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="77" end-line="87"><![CDATA[ * @param string $filePath
 *
 * @return string|null
 * @see https://github.com/laradic/support/blob/master/src/Util.php
 */
function getClassNameFromFile($filePath)
{
    $tokens = token_get_all(file_get_contents($filePath));
    $iMax = count($tokens);
    for ($i = 0; $i < $iMax; $i++) {
        if ($tokens[$i][0] === T_TRAIT || $tokens[$i][0] === T_INTERFACE) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628049" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>109</line>
      <resource><![CDATA[src/reflection.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getNamespaceFromFile() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="104" end-line="114"><![CDATA[ * @param $filePath
 *
 * @return string|null
 * @see https://github.com/laradic/support/blob/master/src/Util.php
 */
function getNamespaceFromFile($filePath)
{
    $namespace = '';
    $tokens = token_get_all(file_get_contents($filePath));
    $iMax = count($tokens);
    for ($i = 0; $i < $iMax; $i++) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628169" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>138</line>
      <resource><![CDATA[src/reflection.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[getPhpDefinitionsFromFile() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="133" end-line="143"><![CDATA[ * @param $filePath
 *
 * @return array
 * @see https://github.com/laradic/support/blob/master/src/Util.php
 */
function getPhpDefinitionsFromFile($filePath)
{
    $classes = [];
    $traits = [];
    $interfaces = [];
    $fp = fopen($filePath, 'r');]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628040" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>10</line>
      <resource><![CDATA[src/sanitize.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[strip_nl() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="5" end-line="15"><![CDATA[    /**
     * Strip new line breaks from a string
     * @param $str
     * @return string|array
     */
    function strip_nl($str)
    {
        return str_replace("\n", "", str_replace("\r", "", $str));
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628150" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>24</line>
      <resource><![CDATA[src/sanitize.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[jse() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="19" end-line="29"><![CDATA[     * Javascript escape
     * @param string $str
     * @return string
     * @source https://github.com/rtconner/laravel-plusplus/blob/laravel-5/src/plus-functions.php
     */
    function jse(string $str): string
    {
        if (isNullOrEmpty($str)) {
            return '';
        }
        $str = str_replace("\n", "", str_replace("\r", "", $str));]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628080" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>41</line>
      <resource><![CDATA[src/sanitize.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[e() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="36" end-line="46"><![CDATA[     * Escape HTML entities in a string.
     *
     * @param  string $value
     * @return string
     */
    function e($value)
    {
        return htmlentities($value, ENT_QUOTES, 'UTF-8', false);
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628098" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>55</line>
      <resource><![CDATA[src/sanitize.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[csse() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="50" end-line="60"><![CDATA[     *
     * @param  string $value
     * @return string
     * @see https://github.com/auraphp/Aura.Html/blob/2.x/src/Escaper/CssEscaper.php
     */
    function csse($value)
    {
        // pre-empt replacement
        if ($value === '' || ctype_digit($value)) {
            return $value;
        }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628015" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>86</line>
      <resource><![CDATA[src/sanitize.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[attre() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="81" end-line="91"><![CDATA[     *
     * @param  string $value
     * @return string
     * @see https://github.com/auraphp/Aura.Html/blob/2.x/src/Escaper/AttrEscaper.php
     */
    function attre($value)
    {
        // pre-empt replacement
        if ($value === '' || ctype_digit($value)) {
            return $value;
        }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628144" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>132</line>
      <resource><![CDATA[src/sanitize.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[she() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="127" end-line="137"><![CDATA[    /**
     * Escape Shell argument.
     * @param string $input
     * @return string
     */
    function she(string $input): string
    {
        if (windows_os()) {
            return '"' . addcslashes($input, '\\"') . '"';
        }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628153" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>153</line>
      <resource><![CDATA[src/sanitize.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[normalizeUtf8String() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="148" end-line="158"><![CDATA[ * @param string $s
 * @return string
 * @see https://github.com/illuminate/support/blob/master/Str.php#L38
 * @see http://php.net/manual/en/normalizer.normalize.php#92592
 */
function normalizeUtf8String(string $s): string
{
    $original_string = $s;

    //Transliterate UTF-8 value to ASCII with chars array map.
    $charsArray = charsArray();]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628017" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>195</line>
      <resource><![CDATA[src/sanitize.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[normalizerUtf8Safe() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="190" end-line="200"><![CDATA[ * exmaple:  Ú => U´,  á => a`
 * @param string $s
 * @param $normalizationForm UTF8 Normalization Form if empty Default Normalizer::FORM_D
 * @return string
 */
function normalizerUtf8Safe(string $s, $normalizationForm): string
{
    if (class_exists('Normalizer', false)) {
        $s = Normalizer::normalize($s, isNullOrEmpty($normalizationForm) ? Normalizer::FORM_D : $normalizationForm);
        return $s;
    }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628081" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>213</line>
      <resource><![CDATA[src/sanitize.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[sanitize_filename() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="208" end-line="218"><![CDATA[ * @param string $charToReplaceWhiteSpace if empty (default) or ' ' then white space ' ' will be preservede
 * othrwise it will be replaced with $charToReplaceWhiteSpace.
 * @return string
 * @see for base script idea http://stackoverflow.com/a/2021729
 */
function sanitize_filename(
    string $fileName,
    bool $sanitizeForPath = false,
    string $charToReplaceWhiteSpace = ' '
): string {
    //check whitespace]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627964" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>283</line>
      <resource><![CDATA[src/sanitize.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[sanitize_pathname() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="278" end-line="288"><![CDATA[ * @param string $charToReplaceWhiteSpace if empty (default) or ' ' then white space ' ' will be preservede
 * othrwise it will be replaced with $charToReplaceWhiteSpace.
 * @return string
 */

function sanitize_pathname(string $pathName, string $charToReplaceWhiteSpace): string
{
    return sanitize_filename($pathName, true, $charToReplaceWhiteSpace);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627992" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>295</line>
      <resource><![CDATA[src/sanitize.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[sanitize_arr_string_xss() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="290" end-line="300"><![CDATA[ *
 * @param array $data
 *
 * @return array
 */
function sanitize_arr_string_xss(array $data): array
{
    foreach ($data as $k => $v) {
        $data[$k] = filter_var($v, FILTER_SANITIZE_STRING);
    }
    return $data;]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627990" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>312</line>
      <resource><![CDATA[src/sanitize.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[sanitize_string_xss() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="307" end-line="317"><![CDATA[ *
 * @return string
 *
 * @see https://github.com/Wixel/GUMP/blob/master/gump.class.php
 */
function sanitize_string_xss(string $data): string
{
    return filter_var($data, FILTER_SANITIZE_STRING);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628047" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>326</line>
      <resource><![CDATA[src/sanitize.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[sanitize_urlencode() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="321" end-line="331"><![CDATA[ *
 * @return string
 *
 * @see https://github.com/Wixel/GUMP/blob/master/gump.class.php
 */
function sanitize_urlencode($value)
{
    return filter_var($value, FILTER_SANITIZE_ENCODED);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628199" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>340</line>
      <resource><![CDATA[src/sanitize.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[sanitize_email() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="335" end-line="345"><![CDATA[ *
 * @return string
 *
 * @see https://github.com/Wixel/GUMP/blob/master/gump.class.php
 */
function sanitize_email($value)
{
    return filter_var($value, FILTER_SANITIZE_EMAIL);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627977" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>354</line>
      <resource><![CDATA[src/sanitize.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[sanitize_numbers() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="349" end-line="359"><![CDATA[ *
 * @return string
 *
 * @see https://github.com/Wixel/GUMP/blob/master/gump.class.php
 */
function sanitize_numbers($value)
{
    return filter_var($value, FILTER_SANITIZE_NUMBER_INT);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628116" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>368</line>
      <resource><![CDATA[src/sanitize.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[sanitize_floats() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="363" end-line="373"><![CDATA[ *
 * @return string
 *
 * @see https://github.com/Wixel/GUMP/blob/master/gump.class.php
 */
function sanitize_floats($value)
{
    return filter_var($value, FILTER_SANITIZE_NUMBER_FLOAT, FILTER_FLAG_ALLOW_FRACTION);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628204" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>386</line>
      <resource><![CDATA[src/sanitize.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[sanitize_phone() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="381" end-line="391"><![CDATA[ * otherwise remove every spaces.
 *
 * @return string
 *
 */
function sanitize_phone($value, bool $preserveSpaces): string
{
    $startsWithPlus = starts_with($value, '+');

    $phone = mb_ereg_replace('([^\d\(\)' . ($preserveSpaces ? '[:space:]' : '') . '])', $preserveSpaces ? ' ' : '', $value);
    $phone = trim($phone);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628035" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>13</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[generateRandomPassword() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="8" end-line="18"><![CDATA[ * $secLevel=3 [A-Za-z0-9-_$!+&%?=*#@] charset.
 * @param int $length
 * @param int $secLevel
 * @return string
 */
function generateRandomPassword(int $length = 10, int $secLevel = 2) : string
{
    $charset = 'abcdefghijklmnopqrstuvwxyz';
    if ($secLevel == 1) {
        $charset = 'abcdefghijklmnopqrstuvwxyz1234567890';
    } elseif ($secLevel == 2) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627957" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>38</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[generateRandomString() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="33" end-line="43"><![CDATA[ * @param int $length
 * @param string $extChars
 * @param string $newChars
 * @return string
 */
function generateRandomString(int $length = 10, string $extChars = '', string $newChars = '') : string
{
    if ($length < 1) {
        $length = 1;
    }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628203" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>77</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[preg_replace_sub() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="72" end-line="82"><![CDATA[     * @param  string $pattern
     * @param  array $replacements
     * @param  string $subject
     * @return string
     */
    function preg_replace_sub($pattern, &$replacements, $subject)
    {
        return preg_replace_callback($pattern, function () use (&$replacements) {
            return array_shift($replacements);
        }, $subject);
    }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628021" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>93</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[snake_case() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="88" end-line="98"><![CDATA[     *
     * @param  string $value
     * @param  string $delimiter
     * @return string
     */
    function snake_case($value, $delimiter = '_')
    {
        $snakeCache = [];
        $key = $value . $delimiter;
        if (isset($snakeCache[$key])) {
            return $snakeCache[$key];]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628124" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>117</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[str_random() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="112" end-line="122"><![CDATA[     * @param  int $length
     * @return string
     *
     * @throws \RuntimeException
     */
    function str_random(int $length = 16)
    {
        if ($length < 0) {
            $length = 16;
        }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627989" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>142</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[ends_with() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="137" end-line="147"><![CDATA[     *
     * @param  string $haystack
     * @param  string|array $needles
     * @return bool
     */
    function ends_with($haystack, $needles)
    {
        if (isNullOrEmpty($haystack) || isNullOrEmpty($needles)) {
            return false;
        }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628065" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>165</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[ends_with_insensitive() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="160" end-line="170"><![CDATA[     *
     * @param  string $haystack
     * @param  string|array $needles
     * @return bool
     */
    function ends_with_insensitive($haystack, $needles)
    {
        if (isNullOrEmpty($haystack) || isNullOrEmpty($needles)) {
            return false;
        }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628105" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>186</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[starts_with() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="181" end-line="191"><![CDATA[     *
     * @param  string $haystack
     * @param  string|array $needles
     * @return bool
     */
    function starts_with($haystack, $needles)
    {
        if (isNullOrEmpty($haystack) || (!is_array($needles) && isNullOrEmpty($needles))) {
            return false;
        }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628020" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>209</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[starts_with_insensitive() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="204" end-line="214"><![CDATA[     *
     * @param  string $haystack
     * @param  string|array $needles
     * @return bool
     */
    function starts_with_insensitive($haystack, $needles)
    {
        if (isNullOrEmpty($haystack) || (!is_array($needles) && isNullOrEmpty($needles))) {
            return false;
        }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628214" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>230</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[str_contains() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="225" end-line="235"><![CDATA[     *
     * @param  string $haystack
     * @param  string|array $needles
     * @return bool
     */
    function str_contains(string $haystack, $needles)
    {
        if (isNullOrEmpty($haystack)) {
            return false;
        }
        if ((is_array($needles) && isNullOrEmptyArray($needles))]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627993" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>258</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[str_contains_insensitive() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="253" end-line="263"><![CDATA[     *
     * @param  string $haystack
     * @param  string|array $needles
     * @return bool
     */
    function str_contains_insensitive($haystack, $needles)
    {
        if (isNullOrEmpty($haystack) || isNullOrEmpty($needles)) {
            return false;
        }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627981" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>279</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[str_finish() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="274" end-line="284"><![CDATA[     *
     * @param  string $value
     * @param  string $cap
     * @return string
     */
    function str_finish($value, $cap)
    {
        if (isNullOrEmpty($value) || isNullOrEmpty($cap)) {
            return false;
        }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627998" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>298</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[str_finish_insensitive() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="293" end-line="303"><![CDATA[     *
     * @param  string $value
     * @param  string $cap
     * @return string
     */
    function str_finish_insensitive($value, $cap)
    {
        if (isNullOrEmpty($value) || isNullOrEmpty($cap)) {
            return false;
        }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628148" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>319</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[str_is() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="314" end-line="324"><![CDATA[     *
     * @param  string $pattern
     * @param  string $value
     * @return bool
     */
    function str_is($pattern, $value)
    {
        if ($pattern == $value) {
            return true;
        }
        $pattern = preg_quote($pattern, '#');]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628193" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>342</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[str_limit() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="337" end-line="347"><![CDATA[     * @param  int $limit
     * @param  string $end append in
     * @param  bool $wordsafe if set to true, remove any truncated word in the end of string so the result no breaking words.
     * @return string
     */
    function str_limit(string $value, int $limit = 100, string $end = '...', bool $wordsafe = false) : string
    {
        $limit = max($limit, 0);
        if (mb_strlen($value) <= $limit) {
            return $value;
        }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628182" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>366</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[str_replace_array() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="361" end-line="371"><![CDATA[     * @param  string $search
     * @param  array $replace
     * @param  string $subject
     * @return string
     */
    function str_replace_array($search, array $replace, $subject)
    {
        foreach ($replace as $value) {
            $subject = preg_replace('/' . $search . '/', $value, $subject, 1);
        }
        return $subject;]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628108" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>382</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[studly_case() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="377" end-line="387"><![CDATA[     * Convert a value to studly caps case.
     *
     * @param  string $value
     * @return string
     */
    function studly_case($value)
    {
        $studlyCache = [];
        $key = $value;
        if (isset($studlyCache[$key])) {
            return $studlyCache[$key];]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628129" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>402</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[studly() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="397" end-line="407"><![CDATA[     * Alias of studly_case
     *
     * @param  string $value
     * @return string
     */
    function studly($value)
    {
        return studly_case($value);
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628201" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>415</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[camel_case() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="410" end-line="420"><![CDATA[     * Convert a value to camel case.
     *
     * @param  string $value
     * @return string
     */
    function camel_case($value)
    {
        $camelCache = [];
        if (isset($camelCache[$value])) {
            return $camelCache[$value];
        }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628197" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>430</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[underscore2dash() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="425" end-line="435"><![CDATA[/**
 * Replace underscores with dashes in the string.
 * @param string $word
 * @return string
 */
function underscore2dash(string $word) : string
{
    return str_replace('_', '-', $word);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628019" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>440</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[dash2underscore() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="435" end-line="445"><![CDATA[/**
 * Make an underscored, lowercase form from the expression in the string.
 * @param string $word
 * @return string
 */
function dash2underscore(string $word) : string
{
    $word = preg_replace('/([A-Z]+)([A-Z][a-z])/', '\1_\2', $word);
    $word = preg_replace('/([a-z])([A-Z])/', '\1_\2', $word);
    return str_replace('-', '_', strtolower($word));
}]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628213" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>456</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[str_replace_multiple_space() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="451" end-line="461"><![CDATA[     * If $withNbsp replaces "&nbsp;" with a single space before converts multiple sequential spaces.
     * @param string $str
     * @param bool $withNbsp
     * @return string
     */
    function str_replace_multiple_space(string $str, bool $withNbsp = false) : string
    {
        if ($withNbsp) {
            $str = str_replace('&nbsp;', ' ', $str);
        }
        return preg_replace('/\s+/', ' ', $str);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628175" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>473</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[str_replace_last() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="468" end-line="478"><![CDATA[     * @param string $search
     * @param string $replace
     * @param string $subject
     * @return string
     */
    function str_replace_last(string $search, string $replace, string $subject) : string
    {
        if ($search == '') {
            return $subject;
        }
        $position = strrpos($subject, $search);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628141" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>499</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[segment() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="494" end-line="504"><![CDATA[     * @param string $subject
     *
     * @return string
     * @see https://github.com/spatie/string/blob/master/src/Str.php
     */
    function segment($delimiter, $index, $subject)
    {
        $segments = explode($delimiter, $subject);
        if ($index < 0) {
            $segments = array_reverse($segments);
            $index = (int)abs($index) - 1;]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628006" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>521</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[firstSegment() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="516" end-line="526"><![CDATA[     * @param string $subject
     *
     * @return string
     * @see https://github.com/spatie/string/blob/master/src/Str.php
     */
    function firstSegment($delimiter, $subject) : string
    {
        return segment($delimiter, 0, $subject);
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628028" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>538</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[lastSegment() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="533" end-line="543"><![CDATA[     * @param string $subject
     *
     * @return string
     * @see https://github.com/spatie/string/blob/master/src/Str.php
     */
    function lastSegment($delimiter, $subject) : string
    {
        return segment($delimiter, -1, $subject);
    }
}
/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627965" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>549</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isNullOrEmpty() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="544" end-line="554"><![CDATA[ * Return true if $subject is null or empty string ('').
 * @param $subject
 * @param bool $withTrim if set to true (default) check if trim()!='' too.
 * @return bool
 */
function isNullOrEmpty($subject, bool $withTrim = true) : bool
{
    return $subject === null || $subject == '' || ($withTrim === true && trim($subject) == '');
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628073" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>560</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isNotNullOrEmpty() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="555" end-line="565"><![CDATA[ * Return true if $subject is not null and is not empty string ('').
 * @param $subject
 * @param bool $withTrim if set to true (default) check if trim()!='' too.
 * @return bool
 */
function isNotNullOrEmpty($subject, bool $withTrim = true) : bool
{
    return !isNullOrEmpty($subject, $withTrim);
}

]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627958" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>575</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[numberToWord() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="570" end-line="580"><![CDATA[ * @param string $locale default 'IT' support only IT or EN
 *
 * @return string converted string
 * @see https://github.com/ngfw/Recipe/blob/master/src/ngfw/Recipe.php
 */
function numberToWord(int $number, string $locale = 'IT') : string
{
    if (isNullOrEmpty($locale) || (strtoupper($locale) != 'IT' && strtoupper($locale) != 'EN')) {
        $locale = 'IT';
    } else {
        $locale = strtoupper($locale);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628118" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>656</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[secondsToText() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="651" end-line="661"><![CDATA[ * @param string $locale 'IT' default, or 'EN'
 *
 * @return string
 * @see https://github.com/ngfw/Recipe/blob/master/src/ngfw/Recipe.php
 */
function secondsToText(int $seconds, bool $returnAsWords = false, string $locale = 'IT') : string
{
    $parts = [];
    $arrPeriod = ($locale == 'EN' ? PERIOD_IN_SECONDS_EN_ARR : PERIOD_IN_SECONDS_ITA_ARR);
    foreach ($arrPeriod as $name => $dur) {
        $div = floor($seconds / $dur);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628128" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>691</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[minutesToText() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="686" end-line="696"><![CDATA[ * @param string $locale 'IT' (default) or 'EN'
 *
 * @return string
 * @see https://github.com/ngfw/Recipe/blob/master/src/ngfw/Recipe.php
 */
function minutesToText(float $minutes, bool $returnAsWords = false, string $locale = 'IT') : string
{
    $seconds = $minutes * 60;
    return secondsToText($seconds, $returnAsWords, $locale);
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628117" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>707</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[hoursToText() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="702" end-line="712"><![CDATA[ * @param string $locale 'IT' (default) or 'EN'
 *
 * @return string
 * @see https://github.com/ngfw/Recipe/blob/master/src/ngfw/Recipe.php
 */
function hoursToText(float $hours, bool $returnAsWords = false, string $locale = 'IT') : string
{
    $seconds = $hours * 3600;
    return secondsToText($seconds, $returnAsWords, $locale);
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627982" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>720</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[str_html_compress() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="715" end-line="725"><![CDATA[    /**
     * Removes whitespace from html and compact it.
     * @param string $value
     * @return string
     */
    function str_html_compress(string $value) : string
    {
        return preg_replace(array('/\>[^\S ]+/s', '/[^\S ]+\</s', '/(\s)+/s'), array('>', '<', '\\1'), $value);
    }
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628134" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>735</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[str_word_count_utf8() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="730" end-line="740"><![CDATA[     * Return zero if an error occourred.
     * @param string $str
     * @return int
     * @see https://github.com/ifsnop/lpsf/blob/master/src/Ifsnop/functions.inc.php
     */
    function str_word_count_utf8(string $str) : int
    {
        $result = preg_match_all("/\p{L}[\p{L}\p{Mn}\p{Pd}'\x{2019}]*/u", $str, $matches);
        return $result === false ? 0 : $result;
    }
}]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628033" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>757</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[slugify() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="752" end-line="762"><![CDATA[     * @param string $separator
     * @return string
     * @see normalizeUtf8String in https://github.com/padosoft/support/blob/master/src/sanitize.php#L150
     * @see https://github.com/illuminate/support/blob/master/Str.php
     */
    function slugify(string $title, string $separator = '-') : string
    {
        //removes all diacritics (marks like accents) from a given UTF8-encoded
        //texts and returns ASCii-text equivalent(if possible).
        $title = normalizeUtf8String($title);
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628069" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>784</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[charsArray() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="779" end-line="789"><![CDATA[     * Returns the replacements for the non-Ascii chars.
     *
     * @return array An array of replacements.
     * @see https://github.com/danielstjules/Stringy/blob/master/src/Stringy.php
     */
    function charsArray()
    {
        return array(
            '0' => array('°', '₀', '۰'),
            '1' => array('¹', '₁', '۱'),
            '2' => array('²', '₂', '۲'),]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628136" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1409</line>
      <resource><![CDATA[src/string.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[charsArrayRegEx() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1404" end-line="1414"><![CDATA[    /**
     * Returns regex to replacements for diacritics, German chars, and non ASCII chars.
     *
     * @return array An array of regex.
     */
    function charsArrayRegEx()
    {
        return array(
            // maps German (umlauts) and other European characters onto two characters
            // before just removing diacritics
            "AE" => '/\x{00c4}/u', // umlaut Ä => AE]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628152" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>9</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isStringNumberStartsWithMoreThanOneZero() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="4" end-line="14"><![CDATA[ * Check if a string number starts with one ore more zero
 * i.e.: 00...000 or 000...0Xxxx.x  with X an int
 * @param $value
 * @return bool
 */
function isStringNumberStartsWithMoreThanOneZero($value)
{
    return preg_match('/^[0]{2,}$/', $value) === 1 || preg_match('/^0{1,}[1-9]{1,}$/', $value) === 1;
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628008" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>22</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isIntegerPositive() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="17" end-line="27"><![CDATA[ * or if $acceptIntegerFloatingPoints==true a floating point that match an positive integer).
 * @param $value
 * @param bool $acceptIntegerFloatingPoints
 * @return bool
 */
function isIntegerPositive($value, $acceptIntegerFloatingPoints = false): bool
{
    return isInteger($value, true, $acceptIntegerFloatingPoints) && $value > 0;
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628155" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>35</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isIntegerNegative() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="30" end-line="40"><![CDATA[ * or if $acceptIntegerFloatingPoints==true a floating point that match an negative integer).
 * @param $value
 * @param bool $acceptIntegerFloatingPoints
 * @return bool
 */
function isIntegerNegative($value, $acceptIntegerFloatingPoints = false): bool
{
    return isInteger($value, false, $acceptIntegerFloatingPoints) && $value < 0;
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628120" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>48</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isIntegerPositiveOrZero() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="43" end-line="53"><![CDATA[ * or if $acceptIntegerFloatingPoints==true a floating point that match an positive integer).
 * @param $value
 * @param bool $acceptIntegerFloatingPoints
 * @return bool
 */
function isIntegerPositiveOrZero($value, $acceptIntegerFloatingPoints = false): bool
{
    return isInteger($value, true, $acceptIntegerFloatingPoints) && $value >= 0;
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628115" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>61</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isIntegerNegativeOrZero() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="56" end-line="66"><![CDATA[ * or if $acceptIntegerFloatingPoints==true a floating point that match an negative integer).
 * @param $value
 * @param bool $acceptIntegerFloatingPoints
 * @return bool
 */
function isIntegerNegativeOrZero($value, $acceptIntegerFloatingPoints = false): bool
{
    return isInteger($value, false, $acceptIntegerFloatingPoints) && $value <= 0;
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627967" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>74</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isIntegerZero() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="69" end-line="79"><![CDATA[ * @param $value
 * @param bool $acceptIntegerFloatingPoints default false
 * @param bool $acceptSign default false if set to true accept -0 and +0 otherwise accept 0.
 * @return bool
 */
function isIntegerZero($value, $acceptIntegerFloatingPoints = false, $acceptSign = false): bool
{
    if(isNullOrEmpty($value)){
        return false;
    }
    if(!$acceptSign){]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628031" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>95</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isInteger() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="90" end-line="100"><![CDATA[ * @param $value
 * @param bool $unsigned
 * @param bool $acceptIntegerFloatingPoints
 * @return bool
 */
function isInteger($value, $unsigned = true, $acceptIntegerFloatingPoints = false): bool
{
    if (isStringNumberStartsWithMoreThanOneZero($value)) {
        return false;
    }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628024" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>117</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isIntegerFloatingPoint() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="112" end-line="122"><![CDATA[ * Ex.: 1, 1e2, 1E2, 1e+2, 1e-2, 1.4e+2, -1.2e+2, -1.231e-2 etc...
 * @param $value
 * @param bool $unsigned
 * @return bool
 */
function isIntegerFloatingPoint($value, $unsigned = true): bool
{
    return isFloatingPoint($value, $unsigned)
        && $value <= PHP_INT_MAX && $value >= PHP_INT_MIN
        //big number rouned to int aproximately!
        //big number change into exp format]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627970" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>134</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isFloatingPoint() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="129" end-line="139"><![CDATA[ * Ex.: [+-]1, [+-]1e2, [+-]1E2, [+-]1e+2, [+-]1e-2, [+-]1.43234e+2, -1.231e+2, -1.231e-2 etc...
 * @param $value
 * @param $unsigned
 * @return bool
 */
function isFloatingPoint($value, $unsigned): bool
{
    if (isStringNumberStartsWithMoreThanOneZero($value)) {
        return false;
    }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628034" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>149</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isIntBool() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="144" end-line="154"><![CDATA[/**
 * Check if the value is a integer/string 0 or 1.
 * @param $value
 * @return bool
 */
function isIntBool($value): bool
{
    return $value === 1 || $value === 0 || $value === '1' || $value === '0';
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628216" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>164</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isDouble() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="159" end-line="169"><![CDATA[ * @param bool $exactDec if set to true aspect number of dec exact to $dec,
 * otherwise $dec is max decimals accepted (0 decimals are also ok in this case).
 * if $dec is an empty string, accept 0 to infinite decimals.
 * @return bool
 */
function isDouble($value, $dec = 2, $unsigned = true, $exactDec = false): bool
{
    if (isStringNumberStartsWithMoreThanOneZero($value)) {
        return false;
    }
    $regEx = '/^' . ($unsigned ? '' : '-{0,1}') . '[0-9]{1,}(\.{1}[0-9]{' . ($exactDec ? '' : '1,') . $dec . '})' . ($exactDec ? '{1}' : '{0,1}') . '$/';]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627975" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>180</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isPercent() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="175" end-line="185"><![CDATA[ * @param $value
 * @param bool $withDecimal if set to true accept decimal values.
 * @param bool $withPercentChar if set to true require % char, otherwise if find a % char return false.
 * @return bool
 */
function isPercent($value, bool $withDecimal = true, bool $withPercentChar = false): bool
{
    if (isNullOrEmpty($value)) {
        return false;
    }
    $contains_perc = str_contains($value, '%');]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628183" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>203</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isInRange() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="198" end-line="208"><![CDATA[ * @param float $value
 * @param float $leftRange
 * @param float $rightRange
 * @return bool
 */
function isInRange(float $value, float $leftRange = 0.00, float $rightRange = 0.00): bool
{
    return ($value <= $rightRange && $value >= $leftRange);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628089" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>213</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isDateIta() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="208" end-line="218"><![CDATA[/**
 * Check if string is dd/mm/YYYY
 * @param $value
 * @return bool
 */
function isDateIta($value): bool
{
    if (isNullOrEmpty($value) || strlen($value) != 10 || strpos($value, '/') === false) {
        return false;
    }
    list($dd, $mm, $yyyy) = explode('/', $value);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628190" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>231</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isDateZeroIso() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="226" end-line="236"><![CDATA[/**
 * Check if string is 0000-00-00
 * @param $value
 * @return bool
 */
function isDateZeroIso($value): bool
{
    return $value == '0000-00-00';
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628217" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>241</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isTimeZeroIso() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="236" end-line="246"><![CDATA[/**
 * Check if string is 00:00:00
 * @param $value
 * @return bool
 */
function isTimeZeroIso($value): bool
{
    return $value == '00:00:00';
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627973" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>251</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isDateTimeZeroIso() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="246" end-line="256"><![CDATA[/**
 * Check if string is '0000-00-00 00:00:00'
 * @param $value
 * @return bool
 */
function isDateTimeZeroIso($value): bool
{
    return $value == '0000-00-00 00:00:00';
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628042" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>261</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isDateOrDateZeroIso() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="256" end-line="266"><![CDATA[/**
 * Check if string is YYYY-mm-dd and valid date or 0000-00-00
 * @param $value
 * @return bool
 */
function isDateOrDateZeroIso($value): bool
{
    return isDateIso($value) || isDateZeroIso($value);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628109" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>271</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isDateTimeOrDateTimeZeroIso() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="266" end-line="276"><![CDATA[/**
 * Check if string is 'YYYY-mm-dd HH:ii:ss' and valid date or '0000-00-00 00:00:00'
 * @param $value
 * @return bool
 */
function isDateTimeOrDateTimeZeroIso($value): bool
{
    return isDateTimeIso($value) || isDateTimeZeroIso($value);
}

]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628018" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>282</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isDateZeroIta() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="277" end-line="287"><![CDATA[/**
 * Check if string is 00/00/0000
 * @param $value
 * @return bool
 */
function isDateZeroIta($value): bool
{
    return $value == '00/00/0000';
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628157" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>292</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isTimeZeroIta() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="287" end-line="297"><![CDATA[/**
 * Check if string is 00:00:00
 * @param $value
 * @return bool
 */
function isTimeZeroIta($value): bool
{
    return $value == '00:00:00';
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628076" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>302</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isDateTimeZeroIta() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="297" end-line="307"><![CDATA[/**
 * Check if string is '00/00/0000 00:00:00'
 * @param $value
 * @return bool
 */
function isDateTimeZeroIta($value): bool
{
    return $value == '00/00/0000 00:00:00';
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627980" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>312</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isDateOrDateZeroIta() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="307" end-line="317"><![CDATA[/**
 * Check if string is dd/mm/YYYY and valid date or 00/00/0000
 * @param $value
 * @return bool
 */
function isDateOrDateZeroIta($value): bool
{
    return isDateIta($value) || isDateZeroIta($value);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628167" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>322</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isDateTimeOrDateTimeZeroIta() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="317" end-line="327"><![CDATA[/**
 * Check if string is 'dd/mm/YYYY HH:ii:ss' and valid date or '00/00/0000 00:00:00'
 * @param $value
 * @return bool
 */
function isDateTimeOrDateTimeZeroIta($value): bool
{
    return isDateTimeIta($value) || isDateTimeZeroIta($value);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628087" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>332</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isDateIso() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="327" end-line="337"><![CDATA[/**
 * Check if string is YYYY-mm-dd
 * @param $value
 * @return bool
 */
function isDateIso($value): bool
{
    if (isNullOrEmpty($value) || strlen($value) != 10 || strpos($value, '-') === false) {
        return false;
    }
    list($yyyy, $mm, $dd) = explode('-', $value);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628106" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>350</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isDateTimeIso() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="345" end-line="355"><![CDATA[/**
 * Check if string is YYYY-mm-dd HH:ii:ss
 * @param $value
 * @return bool
 */
function isDateTimeIso($value): bool
{
    if (!isDateIso(substr($value, 0, 10))) {
        return false;
    }
    return isTimeIso(substr($value, 11));]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628090" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>363</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isDateTimeIta() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="358" end-line="368"><![CDATA[/**
 * Check if string is dd/mm/YYYY HH:ii:ss
 * @param $value
 * @return bool
 */
function isDateTimeIta($value): bool
{
    if (!isDateIta(substr($value, 0, 10))) {
        return false;
    }
    return isTimeIso(substr($value, 11));]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628070" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>376</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isTimeIso() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="371" end-line="381"><![CDATA[/**
 * Check if string is HH:ii:ss
 * @param $value
 * @return bool
 */
function isTimeIso($value): bool
{
    $strRegExp = '/^[0-9]{2}:[0-9]{2}:[0-9]{2}$/';
    if (!(preg_match($strRegExp, $value) === 1)) {
        return false;
    }]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628058" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>391</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isTimeIta() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="386" end-line="396"><![CDATA[/**
 * An alias of isTimeIso.
 * @param $value
 * @return bool
 */
function isTimeIta($value)
{
    return isTimeIso($value);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628083" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>401</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isJewishLeapYear() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="396" end-line="406"><![CDATA[/**
 * Check if year ia a leap year in jewish calendar.
 * @param int $year
 * @return bool
 */
function isJewishLeapYear(int $year): bool
{
    if ($year % 19 == 0 || $year % 19 == 3 || $year % 19 == 6 ||
        $year % 19 == 8 || $year % 19 == 11 || $year % 19 == 14 ||
        $year % 19 == 17
    ) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628103" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>422</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isMonth() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="417" end-line="427"><![CDATA[ * @param int $value
 * @param int $year
 * @param int $calendar
 * @return bool
 */
function isMonth(int $value, int $year, int $calendar = CAL_GREGORIAN): bool
{
    if (!isInRange($year, 0, PHP_INT_MAX)) {
        return false;
    }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628121" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>449</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isDay() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="444" end-line="454"><![CDATA[ * @param int $month
 * @param int $year
 * @param int $calendar
 * @return bool
 */
function isDay(int $value, int $month = 0, int $year = 0, int $calendar = CAL_GREGORIAN): bool
{
    if ($month != 0 && !isMonth($month, $year, $calendar)) {
        return false;
    }
    if (!isInRange($year, 0, PHP_INT_MAX)) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628140" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>479</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[hasMinAge() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="474" end-line="484"><![CDATA[ * @param string $dateOfBirthday date ('Y-m-d') or datetime ('Y-m-d H:i:s') Date Of Birthday
 * @param int $age
 *
 * @return bool
 */
function hasMinAge($dateOfBirthday, int $age): bool
{
    return date_diff(date('Y-m-d'), $dateOfBirthday) >= $age;
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627997" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>492</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[hasMaxAge() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="487" end-line="497"><![CDATA[ * @param string $dateOfBirthday date ('Y-m-d') or datetime ('Y-m-d H:i:s') Date Of Birthday
 * @param int $age
 *
 * @return bool
 */
function hasMaxAge($dateOfBirthday, int $age): bool
{
    return date_diff(date('Y-m-d'), $dateOfBirthday) <= $age;
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628126" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>506</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[hasAgeInRange() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="501" end-line="511"><![CDATA[ * @param int $ageMin
 * @param int $ageMax
 *
 * @return bool
 */
function hasAgeInRange($dateOfBirthday, int $ageMin, int $ageMax): bool
{
    return hasMinAge($dateOfBirthday, $ageMin) && hasMaxAge($dateOfBirthday, $ageMax);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628178" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>519</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[betweenDateIso() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="514" end-line="524"><![CDATA[ * @param string $minDate iso format
 * @param string $maxDate iso format
 * @param bool $strict if set to false (default) check >=min and <=max otherwise check >min and <max.
 * @return bool
 */
function betweenDateIso(string $date, string $minDate, string $maxDate, bool $strict = false): bool
{
    if (!isDateIso($date) || !isDateIso($minDate) || !isDateIso($maxDate)) {
        return false;
    }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628101" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>539</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[betweenDateIta() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="534" end-line="544"><![CDATA[ * @param string $minDate ita format
 * @param string $maxDate ita format
 * @param bool $strict if set to false (default) check >=min and <=max otherwise check >min and <max.
 * @return bool
 */
function betweenDateIta(string $date, string $minDate, string $maxDate, bool $strict = false): bool
{
    if (!isDateIta($date) || !isDateIta($minDate) || !isDateIta($maxDate)) {
        return false;
    }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628085" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>557</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isMail() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="552" end-line="562"><![CDATA[/**
 * @param $value
 * @param $checkMx
 * @return bool
 */
function isMail($value, bool $checkMx = false): bool
{
    if (filter_var($value, FILTER_VALIDATE_EMAIL) === false) {
        return false;
    }
    if ($checkMx) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628168" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>576</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isIPv4() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="571" end-line="581"><![CDATA[/**
 * isIPv4 check if a string is a valid IP v4
 * @param  string $IP2Check IP to check
 * @return bool
 */
function isIPv4($IP2Check): bool
{
    return !(filter_var($IP2Check, FILTER_VALIDATE_IP, FILTER_FLAG_IPV4) === false);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628066" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>586</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isIPv6() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="581" end-line="591"><![CDATA[/**
 * isIPv6 check if a string is a valid IP v6
 * @param  string $IP2Check IP to check
 * @return bool
 */
function isIPv6($IP2Check): bool
{
    return !(filter_var($IP2Check, FILTER_VALIDATE_IP, FILTER_FLAG_IPV6) === false);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628127" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>596</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isIP() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="591" end-line="601"><![CDATA[/**
 * Check if a string is a valid IP (v4 or v6).
 * @param  string $IP2Check IP to check
 * @return bool
 */
function isIP($IP2Check): bool
{
    return !(filter_var($IP2Check, FILTER_VALIDATE_IP) === false);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627984" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>606</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isIPv4Compatibility() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="601" end-line="611"><![CDATA[/**
 * Check if a string is a valid IP v4 compatibility (ffff:ffff:ffff:ffff.192.168.0.15).
 * @param  string $IP2Check IP to check
 * @return bool
 */
function isIPv4Compatibility($IP2Check): bool
{
    return (strrpos($IP2Check, ":") > 0
        && strrpos($IP2Check, ".") > 0
        && isIPv4(substr($IP2Check, strpos($IP2Check, ".") + 1))
        && isIPv6(substr($IP2Check, 0, strpos($IP2Check, ".")) . ':0:0:0:0')]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628000" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>622</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isUrl() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="617" end-line="627"><![CDATA[ * It require scheme to be valide (http|https|ftp|mailto|file|data)
 * i.e.: http://dummy.com and http://www.dummy.com is valid but www.dummy.and dummy.com return false.
 * @param $url
 * @return bool
 */
function isUrl($url): bool
{
    return filter_var($url, FILTER_VALIDATE_URL) !== false;
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628086" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>633</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isHostname() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="628" end-line="638"><![CDATA[ * Check if a string is valid hostname
 * (dummy.com, www.dummy.com, , www.dummy.co.uk, , www.dummy-dummy.com, etc..).
 * @param $value
 * @return bool
 */
function isHostname($value): bool
{
    return preg_match('/(?=^.{4,253}$)(^((?!-)[a-zA-Z0-9-]{0,62}[a-zA-Z0-9]\.)+[a-zA-Z]{2,63}$)/i', $value) === 1;
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628009" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>656</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[urlW3c() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="651" end-line="661"><![CDATA[ * @param string $check Value to check
 * @param bool $strict Require URL to be prefixed by a valid scheme (one of http(s)/ftp(s)/file/news/gopher)
 * @return bool Success
 * @see https://github.com/cakephp/cakephp/blob/master/src/Validation/Validation.php#L839
 */
function urlW3c($check, bool $strict = false): bool
{
    $_pattern = array();
    $pattern = '((([0-9A-Fa-f]{1,4}:){7}(([0-9A-Fa-f]{1,4})|:))|(([0-9A-Fa-f]{1,4}:){6}';
    $pattern .= '(:|((25[0-5]|2[0-4]\d|[01]?\d{1,2})(\.(25[0-5]|2[0-4]\d|[01]?\d{1,2})){3})';
    $pattern .= '|(:[0-9A-Fa-f]{1,4})))|(([0-9A-Fa-f]{1,4}:){5}((:((25[0-5]|2[0-4]\d|[01]?\d{1,2})';]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628171" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>702</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isPiva() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="697" end-line="707"><![CDATA[ * il dato viene considerato opzionale.
 * @param bool $validateOnVIES default false. if se to true, first check algorithm then if it valid,
 * try to check VIES service. If VIES return false or soap exception was thrown, return false.
 * @return bool
 */
function isPiva(string $pi, bool $validateOnVIES = false): bool
{
    if ($pi === null || $pi === '' || strlen($pi) != 11 || preg_match("/^[0-9]+\$/", $pi) != 1) {
        return false;
    }
    $s = 0;]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627962" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>740</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isVATNumber() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="735" end-line="745"><![CDATA[ * @param string $vatNumber
 * @param string $countryCodeDefault default 'IT'
 * @return bool
 * @throws SoapFault
 */
function isVATNumber(string $vatNumber, string $countryCodeDefault = 'IT'): bool
{
    if (!isAlphaNumericWhiteSpaces($vatNumber) || strlen(trim($vatNumber)) < 3) {
        return false;
    }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628185" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>777</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isCf() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="772" end-line="782"><![CDATA[ * sono ammessi caratteri di spazio, per cui i campi di input dell'utente
 * dovrebbero essere trimmati preventivamente. La stringa vuota e' ammessa,
 * cioe' il dato viene considerato opzionale.
 * @return bool
 */
function isCf(string $cf): bool
{
    if ($cf === null || $cf === '' || strlen($cf) != 16) {
        return false;
    }
    $cf = strtoupper($cf);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628147" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>921</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isAlpha() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="916" end-line="926"><![CDATA[ *
 * @return mixed
 *
 * @see https://github.com/Wixel/GUMP/blob/master/gump.class.php
 */
function isAlpha(string $field): bool
{
    return isNotNullOrEmpty($field)
        && preg_match('/^([a-zÀÁÂÃÄÅÇÈÉÊËÌÍÎÏÒÓÔÕÖßÙÚÛÜÝàáâãäåçèéêëìíîïñðòóôõöùúûüýÿ])+$/i', $field) === 1;
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628074" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>936</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isAlphaNumeric() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="931" end-line="941"><![CDATA[ *
 * @return mixed
 *
 * @see https://github.com/Wixel/GUMP/blob/master/gump.class.php
 */
function isAlphaNumeric(string $field): bool
{
    return preg_match('/^([a-z0-9ÀÁÂÃÄÅÇÈÉÊËÌÍÎÏÒÓÔÕÖßÙÚÛÜÝàáâãäåçèéêëìíîïñðòóôõöùúûüýÿ])+$/i', $field) === 1;
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627969" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>949</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isNumeric() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="944" end-line="954"><![CDATA[ * @param string $field
 * @param bool $acceptSign default false if true accept string that starts with +/- oterwise only [0-9] chars.
 *
 * @return mixed
 */
function isNumeric(string $field, bool $acceptSign = false): bool
{
    return preg_match('/^(' . ($acceptSign ? '[+-]{0,1}' : '') . '[0-9])+$/i', $field) === 1;
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628014" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>961</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isNumericWithSign() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="956" end-line="966"><![CDATA[ *
 * @param string $field
 *
 * @return mixed
 */
function isNumericWithSign(string $field): bool
{
    return isNumeric($field, true);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627968" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>973</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isNumericWithoutSign() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="968" end-line="978"><![CDATA[ *
 * @param string $field
 *
 * @return mixed
 */
function isNumericWithoutSign(string $field): bool
{
    return isNumeric($field, false);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627979" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>985</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isAlphaNumericDash() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="980" end-line="990"><![CDATA[ *
 * @param string $field
 *
 * @return mixed
 */
function isAlphaNumericDash($field): bool
{
    return preg_match('/^([a-z0-9ÀÁÂÃÄÅÇÈÉÊËÌÍÎÏÒÓÔÕÖßÙÚÛÜÝàáâãäåçèéêëìíîïñðòóôõöùúûüýÿ\-_])+$/i', $field) === 1;
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628165" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>997</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isAlphaNumericWhiteSpaces() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="992" end-line="1002"><![CDATA[ *
 * @param string $field
 *
 * @return mixed
 */
function isAlphaNumericWhiteSpaces($field): bool
{
    return preg_match('/^([a-z0-9ÀÁÂÃÄÅÇÈÉÊËÌÍÎÏÒÓÔÕÖßÙÚÛÜÝàáâãäåçèéêëìíîïñðòóôõöùúûüýÿ\-_\s])+$/i', $field) === 1;
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628200" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1009</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isBool() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1004" end-line="1014"><![CDATA[ *
 * @param string $field
 *
 * @return mixed
 */
function isBool($field): bool
{
    return $field === true || $field === false;
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628113" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1021</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isBoolOrIntBool() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1016" end-line="1026"><![CDATA[ *
 * @param string $field
 *
 * @return bool
 */
function isBoolOrIntBool($field): bool
{
    return in_array($field, [0, 1, '0', '1', true, false], true);
}

/**]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628037" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1035</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isCrediCard() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1030" end-line="1040"><![CDATA[ *
 * @param string $field
 *
 * @return mixed
 */
function isCrediCard(string $field): bool
{
    if (isNullOrEmpty($field)) {
        return false;
    }
    $number = preg_replace('/\D/', '', $field);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628110" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1070</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isValidHumanName() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1065" end-line="1075"><![CDATA[ *
 * @return mixed
 *
 * @See: https://github.com/Wixel/GUMP/issues/5
 */
function isValidHumanName(string $field): bool
{
    if (isNullOrEmpty($field)) {
        return false;
    }
    return isAlpha($field) && preg_match("/^([ '-])+$/", $field) === 1;]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627955" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1087</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isIban() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1082" end-line="1092"><![CDATA[ *
 * @return bool
 *
 * @see https://github.com/Wixel/GUMP/blob/master/gump.class.php
 */
function isIban($field): bool
{
    if (isNullOrEmpty($field)) {
        return false;
    }
    static $character = array(]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628151" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1139</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[hasFileExtension() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1134" end-line="1144"><![CDATA[ * @param array $allowed_extensions array of extension to match
 *
 * @return bool
 * @see https://github.com/cakephp/cakephp/blob/master/src/Validation/Validation.php
 */
function hasFileExtension($filePath, array $allowed_extensions): bool
{
    $extension = strtolower(pathinfo($filePath, PATHINFO_EXTENSION));
    $allowed_extensions = (array)array_map('mb_strtolower', $allowed_extensions);
    return in_array($extension, $allowed_extensions);
}]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627978" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1169</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isphoneNumber() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1164" end-line="1174"><![CDATA[ *    +1-555-555-5555: valid
 *    +1-(555)-555-5555: valid
 *
 * @see https://github.com/Wixel/GUMP/blob/master/gump.class.php
 */
function isphoneNumber($field): bool
{
    if (isNullOrEmpty($field) || strlen(trim($field)) < 2) {
        return false;
    }
    $field = trim($field);]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628048" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1189</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isJsonString() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1184" end-line="1194"><![CDATA[ *
 * @param string $field
 *
 * @return bool
 */
function isJsonString($field): bool
{
    if (isNullOrEmpty($field)) {
        return false;
    }
    return is_string($field) && is_object(json_decode($field));]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628045" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1204</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isUuid() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1199" end-line="1209"><![CDATA[ * Checks that a value is a valid UUID - http://tools.ietf.org/html/rfc4122
 *
 * @param string $check Value to check
 * @return bool Success
 */
function isUuid($check)
{
    $regex = '/^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[0-5][a-fA-F0-9]{3}-[089aAbB][a-fA-F0-9]{3}-[a-fA-F0-9]{12}$/';
    return preg_match($regex, $check) === 1;
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628003" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1228</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isGeoCoordinate() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1223" end-line="1233"><![CDATA[ *
 * @param string $value Geographic location as string
 * @param array $options Options for the validation logic.
 * @return bool|Exception
 */
function isGeoCoordinate($value, array $options = [])
{
    $_pattern = [
        'latitude' => '[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?)',
        'longitude' => '[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?)',
    ];]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628054" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1264</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isLatitude() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1259" end-line="1269"><![CDATA[ * @param array $options Options for the validation logic.
 * @return bool
 * @link https://en.wikipedia.org/wiki/Latitude
 * @see \Cake\Validation\Validation::geoCoordinate()
 */
function isLatitude($value, array $options = [])
{
    $options['format'] = 'lat';
    return isGeoCoordinate($value, $options);
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628095" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1279</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isLongitude() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1274" end-line="1284"><![CDATA[ * @param array $options Options for the validation logic.
 * @return bool
 * @link https://en.wikipedia.org/wiki/Longitude
 * @see \Cake\Validation\Validation::geoCoordinate()
 */
function isLongitude($value, array $options = []): bool
{
    $options['format'] = 'long';
    return isGeoCoordinate($value, $options);
}
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627974" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1293</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isAscii() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1288" end-line="1298"><![CDATA[ * This method will reject all non-string values.
 *
 * @param string $value The value to check
 * @return bool
 */
function isAscii($value)
{
    if (!is_string($value)) {
        return false;
    }
    return strlen($value) <= mb_strlen($value, 'utf-8');]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551627953" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>1316</line>
      <resource><![CDATA[src/validation.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[isUtf8() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="1311" end-line="1321"><![CDATA[ *
 * @param string $value The value to check
 * @param array $options An array of options. See above for the supported options.
 * @return bool
 */
function isUtf8($value, array $options = []): bool
{
    if (!is_string($value)) {
        return false;
    }
    $options += ['extended' => false];]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628029" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>11</line>
      <resource><![CDATA[src/xml.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[xmlUrl2array() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="6" end-line="16"><![CDATA[ * @param string $url
 * @param int $get_attributes
 * @param string $priority
 * @return array
 */
function xmlUrl2array(string $url, int $get_attributes = 1, string $priority = 'tag') : array
{
    if (!function_exists('xml_parser_create')) {
        return array();
    }
]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628096" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>30</line>
      <resource><![CDATA[src/xml.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[xml2array() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="25" end-line="35"><![CDATA[ * @param string $xml
 * @param int $get_attributes
 * @param string $priority
 * @return array
 */
function xml2array(string $xml, int $get_attributes = 1, string $priority = 'tag') : array
{
    if (!function_exists('xml_parser_create')) {
        return array();
    }
    if (!$xml) {]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628181" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>143</line>
      <resource><![CDATA[src/xml.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[array2xml() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="138" end-line="148"><![CDATA[/**
 * @param array $arrData
 * @param string $rootXml
 * @return string
 */
function array2xml(array $arrData, string $rootXml = '<root></root>') : string
{
    // creating object of SimpleXMLElement
    $objXml = new SimpleXMLElement('<?xml version="1.0"?>' . ($rootXml ? $rootXml : '<root></root>'));
    array2SimpleXMLElement($arrData, $objXml);
    return trim($objXml->asXML());]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628072" rel="self" type="text/html"/>
    </violation>
    <violation severity="major" category="architecture" ignored="false">
      <line>155</line>
      <resource><![CDATA[src/xml.php]]></resource>
      <title>Global variable or function should never be used</title>
      <message><![CDATA[array2SimpleXMLElement() adds to the global scope. Prefer class properties or methods to let other developers know what this relates to.]]></message>
      <context start-line="150" end-line="160"><![CDATA[
/**
 * @param array $arrData
 * @param SimpleXMLElement $objXml
 */
function array2SimpleXMLElement(array $arrData, SimpleXMLElement $objXml)
{
    foreach ($arrData as $key => $value) {
        if (is_array($value)) {
            if (!is_numeric($key)) {
                $subnode = $objXml->addChild(htmlspecialchars("$key"));]]></context>
      <link href="https://insight.sensiolabs.com/projects/fc1e6891-8cb5-40ee-8054-7e47c0411217/analyses/87?status=existing#551628099" rel="self" type="text/html"/>
    </violation>
  </violations>
  <grades>
    <entry><![CDATA[none]]></entry>
    <entry><![CDATA[bronze]]></entry>
    <entry><![CDATA[silver]]></entry>
    <entry><![CDATA[gold]]></entry>
    <entry><![CDATA[platinum]]></entry>
  </grades>
  <failed>false</failed>
  <grade><![CDATA[bronze]]></grade>
  <next-grade><![CDATA[silver]]></next-grade>
  <begin-at><![CDATA[2017-09-16T17:10:06+0200]]></begin-at>
  <end-at><![CDATA[2017-09-16T17:10:45+0200]]></end-at>
  <duration>7</duration>
  <number>87</number>
  <altered>false</altered>
  <remediation-cost>2071.25</remediation-cost>
  <nb-violations>266</nb-violations>
  <reference><![CDATA[c5c110ebf8391f765e249cf9cee43ea3c86bfbcc]]></reference>
  <configuration>
    <ignored-branches>
      <branch><![CDATA[gh-pages]]></branch>
    </ignored-branches>
    <pre-composer-script/>
    <post-composer-script/>
    <working-directory/>
    <php-version/>
    <php-ini/>
    <commit-failure-conditions>
      <branch><![CDATA[project.severity.critical > 0]]></branch>
      <branch><![CDATA[project.severity.major > 0]]></branch>
    </commit-failure-conditions>
    <global-excluded-dirs>
      <dir><![CDATA[vendor]]></dir>
      <dir><![CDATA[vendors]]></dir>
      <dir><![CDATA[test]]></dir>
      <dir><![CDATA[tests]]></dir>
      <dir><![CDATA[Tests]]></dir>
      <dir><![CDATA[spec]]></dir>
      <dir><![CDATA[features]]></dir>
      <dir><![CDATA[Fixtures]]></dir>
      <dir><![CDATA[DataFixtures]]></dir>
      <dir><![CDATA[var]]></dir>
    </global-excluded-dirs>
    <excluded-patterns>
      <pattern><![CDATA[app/check.php]]></pattern>
      <pattern><![CDATA[app/SymfonyRequirements.php]]></pattern>
      <pattern><![CDATA[public/index.php]]></pattern>
      <pattern><![CDATA[web/config.php]]></pattern>
      <pattern><![CDATA[web/app_*.php]]></pattern>
      <pattern><![CDATA[config/bootstrap.php]]></pattern>
    </excluded-patterns>
    <patterns>
      <file>
        <pattern><![CDATA[*.php]]></pattern>
        <pattern><![CDATA[*.twig]]></pattern>
        <pattern><![CDATA[*.xml]]></pattern>
        <pattern><![CDATA[*.yml]]></pattern>
        <pattern><![CDATA[*.yaml]]></pattern>
        <pattern><![CDATA[*.ini]]></pattern>
        <pattern><![CDATA[*.dist]]></pattern>
        <pattern><![CDATA[*.sql]]></pattern>
        <pattern><![CDATA[*.md]]></pattern>
        <pattern><![CDATA[*.rst]]></pattern>
        <pattern><![CDATA[composer.*]]></pattern>
        <pattern><![CDATA[.gitignore]]></pattern>
        <pattern><![CDATA[LICENSE]]></pattern>
        <pattern><![CDATA[README]]></pattern>
        <pattern><![CDATA[Makefile]]></pattern>
        <pattern><![CDATA[.htaccess]]></pattern>
      </file>
      <php>
        <pattern><![CDATA[*.php]]></pattern>
      </php>
      <twig>
        <pattern><![CDATA[*.twig]]></pattern>
      </twig>
    </patterns>
    <rules>
      <rule name="symfony.use_dir_file_constant" enabled="false"/>
    </rules>
    <parameters>
      <parameter name="project_type">1</parameter>
    </parameters>
    <env/>
    <notifications/>
  </configuration>
  <previous-analyses-references>
    <analysis-reference number="87">c5c110ebf8391f765e249cf9cee43ea3c86bfbcc</analysis-reference>
    <analysis-reference number="86">c5c110ebf8391f765e249cf9cee43ea3c86bfbcc</analysis-reference>
    <analysis-reference number="85">b2b28713b082a31cdd636e3a49d52a8fb04061a8</analysis-reference>
    <analysis-reference number="84">b2b28713b082a31cdd636e3a49d52a8fb04061a8</analysis-reference>
    <analysis-reference number="83">5521135075abc090fc4ebabea20367436cd7262e</analysis-reference>
    <analysis-reference number="82">47bfcf3ff9f27ba4f070f617d981dd93bbeae461</analysis-reference>
    <analysis-reference number="81">47bfcf3ff9f27ba4f070f617d981dd93bbeae461</analysis-reference>
    <analysis-reference number="80">47bfcf3ff9f27ba4f070f617d981dd93bbeae461</analysis-reference>
    <analysis-reference number="79">47bfcf3ff9f27ba4f070f617d981dd93bbeae461</analysis-reference>
    <analysis-reference number="78">47bfcf3ff9f27ba4f070f617d981dd93bbeae461</analysis-reference>
    <analysis-reference number="77">d121adf6a395bb92481a8ebf912e12850169a124</analysis-reference>
    <analysis-reference number="76">1fed9aabc5c13658d14a5a97b2332224374ebf90</analysis-reference>
    <analysis-reference number="75">9079845cdba1b4dbc4df718511dfb6f8f283c7e2</analysis-reference>
    <analysis-reference number="74">9079845cdba1b4dbc4df718511dfb6f8f283c7e2</analysis-reference>
    <analysis-reference number="73">723051499ce4beb28a86202b501b6189cec97c87</analysis-reference>
    <analysis-reference number="72">723051499ce4beb28a86202b501b6189cec97c87</analysis-reference>
    <analysis-reference number="71">723051499ce4beb28a86202b501b6189cec97c87</analysis-reference>
    <analysis-reference number="70">723051499ce4beb28a86202b501b6189cec97c87</analysis-reference>
    <analysis-reference number="68">ec6ab3b351ccf8ab3e86e017aa1ab6cbc1e05402</analysis-reference>
    <analysis-reference number="67">ec6ab3b351ccf8ab3e86e017aa1ab6cbc1e05402</analysis-reference>
    <analysis-reference number="66">6a895f15a6f88384aeffb506f9b2eb1a2705fb01</analysis-reference>
    <analysis-reference number="65">2be6eac6098dcee33c00aac27dd19983eb71ef7f</analysis-reference>
    <analysis-reference number="64">f58ce7116074e6f1a1790e744607c4f808129404</analysis-reference>
    <analysis-reference number="63">3b0909cffd4f46fbf65fae58801c06a4f4aa7c19</analysis-reference>
    <analysis-reference number="62">84d5900da6e956842cf5083854cdc513c422e66c</analysis-reference>
    <analysis-reference number="61">988869c35fb59d8ed0de7118f3e38d9caedda69b</analysis-reference>
    <analysis-reference number="60">988869c35fb59d8ed0de7118f3e38d9caedda69b</analysis-reference>
    <analysis-reference number="59">9d4be0fe5f1ef4abc9bb2eea4a3187de493669b3</analysis-reference>
    <analysis-reference number="58">9d4be0fe5f1ef4abc9bb2eea4a3187de493669b3</analysis-reference>
    <analysis-reference number="57">9d4be0fe5f1ef4abc9bb2eea4a3187de493669b3</analysis-reference>
    <analysis-reference number="55">335c4ef6b50611b1e7d4032c5c8c0f7fafb83b27</analysis-reference>
    <analysis-reference number="54">bf43fb635c78287978b27211e7221daa1d9d6c95</analysis-reference>
    <analysis-reference number="53">bf43fb635c78287978b27211e7221daa1d9d6c95</analysis-reference>
    <analysis-reference number="52">c2228475fbb5b5b9a63d7115e9c6e02ab3005645</analysis-reference>
    <analysis-reference number="51">c2228475fbb5b5b9a63d7115e9c6e02ab3005645</analysis-reference>
    <analysis-reference number="50">c2228475fbb5b5b9a63d7115e9c6e02ab3005645</analysis-reference>
    <analysis-reference number="49">b20047df025c4493401e0149eb391ca9f64ae4df</analysis-reference>
    <analysis-reference number="48">b20047df025c4493401e0149eb391ca9f64ae4df</analysis-reference>
    <analysis-reference number="47">43547cfc3faff1449be7976401457b8607884619</analysis-reference>
    <analysis-reference number="46">d0cfcf2dfbc5bef8744330b5793b146d4fbb9128</analysis-reference>
    <analysis-reference number="45">d0cfcf2dfbc5bef8744330b5793b146d4fbb9128</analysis-reference>
    <analysis-reference number="44">5b081fe20b0c18651c853020871b02c8c1e5b6aa</analysis-reference>
    <analysis-reference number="43">5b081fe20b0c18651c853020871b02c8c1e5b6aa</analysis-reference>
    <analysis-reference number="42">fb68e603a0c93b0ef34b2bc0fb8b8a3695acb118</analysis-reference>
    <analysis-reference number="40">62b3010b210b42e83195aa4613c3c46d3d238162</analysis-reference>
    <analysis-reference number="39">62b3010b210b42e83195aa4613c3c46d3d238162</analysis-reference>
    <analysis-reference number="38">ef2e95430cc5f959a4745861ff4c05b12639bb1d</analysis-reference>
    <analysis-reference number="37">ef2e95430cc5f959a4745861ff4c05b12639bb1d</analysis-reference>
    <analysis-reference number="36">006f0be2c6133c10d2d696d2fce8dc2b632f3129</analysis-reference>
    <analysis-reference number="35">006f0be2c6133c10d2d696d2fce8dc2b632f3129</analysis-reference>
    <analysis-reference number="34">9a2382abe4a2502e0532bc95fb51c59fc5b9da21</analysis-reference>
    <analysis-reference number="33">cf3bfcfac76d8a0b55a4e1124c73a46219f4c72c</analysis-reference>
    <analysis-reference number="32">49181ceceb08610e010727a73e552305ffbbb5d7</analysis-reference>
    <analysis-reference number="31">49181ceceb08610e010727a73e552305ffbbb5d7</analysis-reference>
    <analysis-reference number="30">1633f463e5877689af74305ca6db761fa0f1c24a</analysis-reference>
    <analysis-reference number="29">288481a7409846e918764963c0428e4540bcab6e</analysis-reference>
    <analysis-reference number="28">95263082673a100e4b119f5cbbc31e85ea8d4c74</analysis-reference>
    <analysis-reference number="27">95263082673a100e4b119f5cbbc31e85ea8d4c74</analysis-reference>
    <analysis-reference number="26">d579257f8697726765fb915a545944af3ea967eb</analysis-reference>
    <analysis-reference number="25">1efa22c91f32083e01c4cd8ec60a7436aef8f206</analysis-reference>
    <analysis-reference number="24">1efa22c91f32083e01c4cd8ec60a7436aef8f206</analysis-reference>
    <analysis-reference number="23">7d4ece4775eadab79dce4fbe0a1d9e25410eebb7</analysis-reference>
    <analysis-reference number="22">a654e31442d34e0b438db1329d6c8a262c3542e3</analysis-reference>
    <analysis-reference number="21">b567c3526ec93f4fc6ee306251ef9b6b6cfa4120</analysis-reference>
    <analysis-reference number="20">841ded1894229301c468f721bd493e0647d7761b</analysis-reference>
    <analysis-reference number="19">841ded1894229301c468f721bd493e0647d7761b</analysis-reference>
    <analysis-reference number="18">d6b710035a2f73cfbcd6ac8a74cce89678e8e311</analysis-reference>
    <analysis-reference number="17">d6b710035a2f73cfbcd6ac8a74cce89678e8e311</analysis-reference>
    <analysis-reference number="16">e2641ce6c7b782b593b36f4d1adc90a1d5830200</analysis-reference>
    <analysis-reference number="15">4bf1e704a4681758747bae7df2ea0791bf0cecc7</analysis-reference>
    <analysis-reference number="14">25d319083476a02c5894468e24a1f79e6c6aec24</analysis-reference>
    <analysis-reference number="13">9802ab013ce8aaf1e189d1a1d9b76d24fe586f94</analysis-reference>
    <analysis-reference number="12">328ae36ec8336263ac5df1b556837ac82cd6f096</analysis-reference>
    <analysis-reference number="11">818ba873715d36d972394a735313d3267835d46c</analysis-reference>
    <analysis-reference number="10">6f3a7a3f93a35ecf090aee0b11a5e27bbb021cb0</analysis-reference>
    <analysis-reference number="9">5f0ee225ba2e033b991d456d5c63baabb857a8de</analysis-reference>
    <analysis-reference number="8">5f0ee225ba2e033b991d456d5c63baabb857a8de</analysis-reference>
    <analysis-reference number="7">ceb60c03edf0df333c61ddb027eda746b76957d6</analysis-reference>
    <analysis-reference number="6">79f2053eb478f9c729db2caf4f215228e5ead948</analysis-reference>
    <analysis-reference number="5">35e698dd1fc3393408b0ff38edc8912e1d1fa8eb</analysis-reference>
    <analysis-reference number="4">35e698dd1fc3393408b0ff38edc8912e1d1fa8eb</analysis-reference>
    <analysis-reference number="3">038af31d93b41979b7a7cf5ab6d5d487e25dfb33</analysis-reference>
    <analysis-reference number="2">33cdc3938b2e184dfb55b083120b6ac1955ecd7d</analysis-reference>
    <analysis-reference number="1">4e34ab3606fa29807c045f008583279bcc6cd297</analysis-reference>
  </previous-analyses-references>
  <nb-violations-new>1</nb-violations-new>
  <nb-violations-existing>265</nb-violations-existing>
  <nb-violations-fixed>0</nb-violations-fixed>
  <nb-violations-ignored>0</nb-violations-ignored>
</analysis>
